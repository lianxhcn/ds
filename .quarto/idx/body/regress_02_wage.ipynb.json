{"title":"线性回归分析","markdown":{"yaml":{"title":"线性回归分析"},"headingText":"简介","containsRefs":false,"markdown":"\n\n\n\n\n\n\n提示词：\n\n翻译为中文，讲义风格。为了符合中文表述喜欢，可以适当意译。\n关键变量，如 Y, X 都用 Latex 格式，即 $Y$, $X$\n所有圆括号都采用半角模式；\n中英文混排加空格。\n\nSource: Chernozhukov, V. & Hansen, C. & Kallus, N. & Spindler, M. & Syrgkanis, V. (**2024**): Applied Causal Inference Powered by ML and AI. [CausalML-book.org](https://causalml-book.org/); arXiv:2403.02467. [-PDF-](https://arxiv.org/pdf/2403.02467)，[Website](https://causalml-book.org/), [github](https://github.com/CausalAIBook/MetricsMLNotebooks) &rarr; [This Note](https://github.com/CausalAIBook/MetricsMLNotebooks/blob/main/PM1/python-ols-and-lasso-for-wage-prediction.ipynb) \n\n\n在劳动经济学中，一个核心问题是：工人的工资 $Y$ 由什么因素决定？虽然这是一个因果推断问题，但我们可以先从预测的角度进行分析。\n\n在下面的工资案例中，$Y$ 表示工人的（对数）小时工资，$X$ 是工人的特征向量，例如教育、工作经验、性别等。这里我们关注两个主要问题：\n\n* 如何利用与工作相关的特征（如教育和经验）更好地预测工资 $Y$？\n* 在其他工作相关特征 $X$ 相同的情况下，男性和女性工人的预测工资有何不同？\n\n本实验首先聚焦于回归分析和预测问题。\n\n## 数据说明\n\n本次分析的数据来源于 2015 年美国现行人口调查（CPS）三月补充调查。我们筛选了 25 至 64 岁的白人非西班牙裔个体，要求每年工作超过 50 周且每周工作时间超过 35 小时。排除了自雇人员、居住在集体宿舍的个体、军人、农业或私人家庭部门的个体，以及在收入和就业状态报告上存在不一致、变量有缺失或分配信息的观测，同时剔除了小时工资低于 3 的样本。\n\n我们关注的核心变量 $Y$，即（对数）小时工资率，是由年收入除以总工作小时数得到的。其中，总工作小时数等于每年工作周数乘以每周通常工作小时数。在分析中，我们还聚焦于未婚（从未结婚）工人。最终样本量为 $n=5150$。\n\n\n### 变量标签与变量解释\n\n下面列示了该数据集中每个变量的常用英文标签及中文解释说明。部分变量根据 CPS 典型设定和相关代码本推断并补充。\n\n\n| 变量名   | 英文标签                         | 中文解释                          |\n| -- | - | -- |\n| wage  | Hourly wage                  | 小时工资（美元）                      |\n| lwage | Log hourly wage              | 小时工资的对数                       |\n| sex   | Female (1=Female)            | 性别（女性=1，男性=0）                 |\n| shs   | <12 years of schooling       | 教育年限未满 12 年（未完成高中）            |\n| hsg   | High school graduate         | 高中毕业                          |\n| scl   | Some college                 | 大学肄业（上过大学但未获得学位）              |\n| clg   | College graduate             | 大学毕业（获得学士学位）                  |\n| ad    | Advanced degree              | 研究生学历（硕士或博士）                  |\n| mw    | Midwest region               | 美国中西部地区（居住地）                  |\n| so    | South region                 | 美国南部地区（居住地）                   |\n| we    | West region                  | 美国西部地区（居住地）                   |\n| ne    | Northeast region             | 美国东北地区（居住地）                   |\n| exp1  | Potential experience         | 潜在工作经验年数（age - education - 6） |\n| exp2  | Potential experience squared | 潜在工作经验年数的平方                   |\n| exp3  | Potential experience cubed   | 潜在工作经验年数的三次方                  |\n| exp4  | Potential experience^4       | 潜在工作经验年数的四次方                  |\n| occ   | Occupation code              | 职业代码（细分，通常为 3-5 位数）           |\n| occ2  | Major occupation group       | 职业大类代码（22 类）                  |\n| ind   | Industry code                | 行业代码（细分，通常为 3-5 位数）           |\n| ind2  | Major industry group         | 行业大类代码（22 类）                  |\n\n\n### 变量进一步解释和常见分组\n\n* **学历变量（shs, hsg, scl, clg, ad）**\n  这些是**互斥**的 dummy 变量，每个人只能属于其中一个。常见定义如下：\n\n  * `shs`: 小于高中毕业（未完成高中学业）\n  * `hsg`: 高中毕业但没有上过大学\n  * `scl`: 上过大学但未毕业（包括两年制大学、部分大学课程等，未获得学位）\n  * `clg`: 获得学士学位（本科毕业）\n  * `ad`: 获得更高学位（硕士及以上）\n\n* **地区变量（mw, so, we, ne）**\n  根据居住地划分的美国四大区域，具体可以参考美国人口调查标准地区定义。\n\n* **经验变量（exp1, exp2, exp3, exp4）**\n  经验变量通常由公式 $exp1 = \\text{age} - \\text{years of schooling} - 6$ 计算，近似代表进入劳动力市场的年数，其高次项常用于工资方程中的经验-工资非线性关系建模。\n\n* **职业/行业变量（occ, occ2, ind, ind2）**\n\n  * `occ`/`ind` 为细分的职业/行业代码，通常来自于 CPS 的详细分类。\n  * `occ2`/`ind2` 则为大类分组，便于建模和控制大类异质性。\n\n\n### 参考说明与代码本依据\n\n这些变量的定义可参考 CPS（Current Population Survey）文档和相关学术论文，例如：\n\n- Angrist, J. D., & Pischke, J.-S. (2009). *Mostly Harmless Econometrics: An Empiricist's Companion*. Princeton University Press. [Link](https://press.princeton.edu/books/paperback/9780691120355/mostly-harmless-econometrics), [Google](https://scholar.google.com/scholar?q=Mostly+Harmless+Econometrics).\n- Card, D., & Krueger, A. B. (1992). School Quality and Black-White Relative Earnings: A Direct Assessment. *Quarterly Journal of Economics*, 107(1), 151–200. [Link](https://doi.org/10.2307/2118323), [PDF](http://sci-hub.ren/10.2307/2118323), [Google](https://scholar.google.com/scholar?q=School+Quality+and+Black-White+Relative+Earnings).\n\n\n### 相关 R/Python 代码标签举例\n\n常见的学历 dummies 在原始代码中的构造（R/Python 通用思路）：\n\n```python\n# Python 示意\ndf[\"shs\"] = (df[\"educ\"] < 12).astype(int)\ndf[\"hsg\"] = (df[\"educ\"] == 12).astype(int)\ndf[\"scl\"] = ((df[\"educ\"] > 12) & (df[\"educ\"] < 16)).astype(int)\ndf[\"clg\"] = (df[\"educ\"] == 16).astype(int)\ndf[\"ad\"] = (df[\"educ\"] > 16).astype(int)\n```\n\n\n## 基本数据分析\n\n本节将对数据进行初步分析，包括：\n\n- 生成一些新变量，以便于后续分组绘图；\n- 探索性数据分析：采用散点图、箱线图、小提琴图等可视化工具，分析工资在不同子样本 (不同教育水平、不同地区、不同性别等) 下的分布情况，以便初步了解工资与各个特征之间的关系；\n- 计算工资的描述性统计量（均值、中位数、标准差等）；\n- 采用分仓散点图和回归线，分析工资与潜在工作经验之间的关系。\n\n\n### 变量生成及变量标签\n\n在本节中，我们将对数据集进行变量生成和标签定义，以便后续分析和建模。\n\n- 基于 sex 生成新变量：带标签的变量 sex_label\n  - `sex_label`：{0: Male; 1: Female}，表示性别。我们将其转换为字符串标签。\n\n- 教育水平和地区\n  - 定义一个新变量：edu_group，表示教育水平的分组，取值为 `{'shs': '<HS', 'hsg': 'HS', 'scl': 'Some College', 'clg': 'College', 'ad': 'Advanced'}`。后续分析中采用这个变量更便于分组绘图和统计分析。\n  - 定义一个新变量：regeion，表示居住地区的分组，取值为 `{'mw': 'Midwest', 'so': 'South', 'we': 'West', 'ne': 'Northeast'}`。后续分析中采用这个变量更便于分组绘图和统计分析。\n\n\n### 不同职业类别的工资分布\n\n### 不同行业类别的工资分布\n\n## 不同教育水平的工资分布\n\n使用 `edu_group` 变量绘制不同教育水平的工资分布图。可以使用箱线图（boxplot）或小提琴图（violin plot）来展示不同教育水平下工资的分布情况。\n\n::: {.callout-tip}\n### 提示词\n使用 `edu_group` 变量绘制不同教育水平的工资分布图：\n\n- 小提琴图：颜色-深黄色；\n- 纵轴刻度：0(5)100；\n- Sample: wage < 100；\n- 添加浅灰色横向网格线，间隔 5\n\n:::\n\n\n### 箱线图：不同教育水平的工资分布\n\n### 不同教育水平下的工资性别差异\n\n::: {.callout-tip}\n### 提示词\n在每个教育水平组内，进一步区分 Male 和 Female，绘制箱线图。\n- 箱线图箱体填充色 Male: 深蓝色；Female：金黄色\n- legend：放在左上角\n- y 轴范围：0(10)80\n:::\n\n按区域和性别来展示工资的箱线图。\n\n- 首先，根据地区（region）和性别（sex）将原始数据 `df` 转换成长格式 `long_df_region`，便于后续分组绘图。\n- 接着，利用 seaborn 的 `boxplot` 和 `stripplot`，分别绘制了不同地区和性别组合下工资（`wage` 或 `lwage`）的箱线图和散点分布。\n\n\n### 不同地区的工资分布\n\n::: {.callout-tip}\n### 提示词\n\n1. 使用 `region` 变量绘制不同地区 Male 和 Female 的工资分布图：\n2. 箱线图 + 散点图\n3. 箱线图：无需填充箱体颜色\n   - 边框颜色：Male-深蓝色；Female-深黄色；\n   - 纵轴刻度：0(5)100；添加浅灰色横向网格线\n   - Sample: wage < 100；\n4. 散点：Male-深蓝色；Female-深黄色；透明度：0.18\n5. legend: 能区分 Male 和 Female 即可 \n\n:::\n\n简要分析：\n\n- 男性和女性在不同地区的工资分布存在明显差异，尤其是在 '中西部 (Midwest)' 和 '西部 (West)' 地区，男性的工资中位数普遍高于女性。不过，这种工资的性别差异相比于教育水平的差异要小得多。\n- 在 '南部 (South)'，男性和女性的工资分布较为接近。\n- 在 '东北部 (Northeast)'，女性的工资甚至略高于男性。\n\n### 组间均值差异检验\n\n在实际经济与社会数据分析中，我们经常需要比较两个不同群体（如男性与女性、实验组与对照组、不同地区等）的平均水平是否存在统计学上的显著差异。例如，在本例中，我们关注 Midwest 区域男性与女性的平均工资是否不同。这一问题本质上属于**组间均值差异检验**。\n\n#### 检验思路\n\n假设有两组独立观测值 $X_{1,1}, ..., X_{1,n_1}$（如男性工资）与 $X_{2,1}, ..., X_{2,n_2}$（如女性工资），我们关注这两组样本的均值是否存在显著差异。统计学上，常用的检验方法是**两独立样本 t 检验**。\n\n* **原假设**（$H_0$）：两组总体均值相等，即 $ \\mu_1 = \\mu_2 $\n* **备择假设**（$H_1$）：两组总体均值不等，即 $ \\mu_1 \\neq \\mu_2 $\n\n#### t 统计量的构建与分布\n\n假设两组观测值独立，且服从正态分布。若不假定两组方差相等（更贴合实际），则采用 Welch t 检验，t 统计量的计算公式为：\n\n$$\nt = \\frac{ \\bar{X}_1 - \\bar{X}_2 }{ \\sqrt{ \\frac{S_1^2}{n_1} + \\frac{S_2^2}{n_2} } } \\sim t(k)\n$$\n\n其中：\n\n* $ \\bar{X}_1, \\bar{X}_2 $ 为两组样本均值\n* $ S_1^2, S_2^2 $ 为两组样本方差\n* $ n_1, n_2 $ 为两组样本容量\n\n自由度为\n\n$$\nk = \\frac{ \\left( \\frac{S_1^2}{n_1} + \\frac{S_2^2}{n_2} \\right)^2 }{ \\frac{ (S_1^2 / n_1)^2 }{ n_1 - 1 } + \\frac{ (S_2^2 / n_2)^2 }{ n_2 - 1 } }\n$$\n\n在 $H_0$ 成立的前提下，t 统计量服从自由度为 $k$ 的 t 分布（即 Welch–Satterthwaite 近似）。若两组样本方差相等，则简化为标准的 t 检验，即 \n\n$$\nt = \\frac{ \\bar{X}_1 - \\bar{X}_2 }{ \\sqrt{ \\frac{S^2}{n_1} + \\frac{S^2}{n_2} } } \\sim t(n_1 + n_2 - 2)\n$$\n\n\n#### 显著性判别\n\n* 计算得到的 t 统计量越大，说明两组样本均值差异越显著。\n* 通过查找 t 分布的分位点或直接计算 P 值，判断观察到的样本均值差异出现的概率有多大。\n* 若 P 值小于设定的显著性水平（如 0.05），则拒绝原假设，认为两组均值存在显著差异。\n\n\n::: {.callout-tip}\n### 提示词\n\n采用 t-test 检验 Midwest 区域的 Male 和 Female 的平均工资是否存在显著差异。\n:::\n\n### 组间均值差异检验：多组比较\n\n::: {.callout-tip}\n### 提示词\n\n1. 目的：用于检验多个组内 (如 edu_group 或 region) 的 Male 和 Female 的平均工资是否存在显著差异。\n2. 分别使用 `edu_group` 和 `region` 变量进行分组检验。\n3. 输出每个组的平均工资和 t-test 的结果。\n   - 列示：mean1, mean2, diff (小数点后保留一位有效数字); t-statistic, p-value (小数点后保留三位)\n   - 列明：采用极简方式，如 'Male', 'Female', 'diff', 't', 'p-value'\n4. 可以调用好用的包，提供尽可能简洁的代码\n:::\n\n## wage 与 experience 的关系\n\n- 绘制 wage 和 experience 的 '散点图+线性回归线 (+ 95% CI)' 图。\n- 绘制 wage 和 experience 的 '散点图+二次曲线拟合线 (+ 95% CI)' 图。(省略了)\n\n\n## 分仓散点图\n\n- 绘制 wage 和 experience 的 '分仓散点图 (binscatter)+线性回归线 (+ 95% CI)' 图。\n\n### 变量构造\n\n我们在本节中构造了输出变量 $Y$ 以及包含工人特征的特征矩阵 $Z$，这些特征均来源于原始数据集。\n\nFor the outcome variable (log) wage and a subset of the raw regressors, we calculate the empirical mean and other empirical measures to get familiar with the data.\n\n\n\n例如，我们样本中女性工人占比约为 44%（$sex=1$ 表示女性）。\n\n## 预测\n\n接下来，我们将构建一个关于小时（对数）工资 $Y$ 的预测规则，假设 $Y$ 与与工作相关的特征 $X$ 之间存在线性关系：\n\n$$\nY = \\beta' X + \\epsilon \\tag{1}\n$$\n\n我们的目标包括：\n\n* 利用工人的多种特征预测工资水平，包括：\n  - 教育水平（如高中毕业、大学毕业等）；\n  - 工作经验（如潜在工作经验）；\n  - 性别（男性或女性）；\n  - 居住地区（如中西部、南部等）。\n* 通过（调整后的）样本均方误差（MSE）、（调整后的）样本 $R^2$ 以及样本外的 MSE 和 $R^2$，评估模型的预测能力。\n  \n  - $MSE = \\frac{1}{n} \\sum_{i=1}^{n} (Y_i - \\hat{Y}_i)^2$，其中 $\\hat{Y}_i$ 是模型预测的工资；\n  \n  - $R^2 = 1 - \\frac{MSE}{\\text{Var}(Y)}$，其中 $\\text{Var}(Y)$ 是工资的样本方差。\n  - $\\bar{R}^2 = 1 - \\frac{(1-R^2)(n-1)}{n-k-1}$，其中 $k$ 是模型中使用的特征数量。\n  - 样本外的 MSE 和 $R^2$ 是将基于训练样本得到的系数估计值带入测试样本中计算而得。\n\n为实现上述目标，我们采用数据拆分（data splitting）的方法来衡量两种模型的预测效果：\n\n- 随机将数据集分为训练集和测试集（更复杂的做法如分层抽样可进一步提升效果，这里仅用最基础的随机拆分）；\n- 在训练集上估计基本模型和灵活模型的参数；\n- 在使用测试集前，先评估模型在训练集上的拟合表现。\n\n\n我们采用两种不同的预测模型设定：\n\n1. **基础模型（Basic Model）**：$X$ 包含一组原始解释变量（如性别、工作经验、学历虚拟变量、职业和行业虚拟变量、地区虚拟变量等）。\n\n2. **灵活模型（Flexible Model）**：$X$ 不仅包含基础模型中的所有原始解释变量，还加入了变量变换（如 ${exp}^2$、${exp}^3$ 等高次项）以及工作经验与其他解释变量的两两交互项。例如，“工作经验 × 大学学历指示变量”就是一种典型的交互项。\n\n采用**灵活模型**可以用更复杂的回归函数来逼近真实关系，从而降低偏差。灵活模型拓展了回归函数的可能形状范围。一般来说，灵活模型往往能带来更高的预测准确性，但模型解释性会变弱。\n\n我们也可以将灵活模型视为「变系数模型」，具体说明如下。\n\n假设基础模型设定如下：\n\n$$\nY_i = \\alpha_1 + \\beta X_{i} + \\gamma W_{i} + \\varepsilon_i \\tag{2}\n$$\n\n其中 $X_i$ 是一组原始解释变量，$W_i$ 是一组控制变量。$X$ 对 $Y$ 的边际影响可以表示为：\n\n$$\n\\frac{\\partial Y_i}{\\partial X_i} = \\beta  \\tag{3}\n$$\n\n在基础模型中，$\\beta$ 是一个常数，表示 $X$ 对 $Y$ 的边际影响是恒定的。然而，现实中，$X$ 对 $Y$ 的影响可能会随着其他变量（如工作经验、教育水平等）的变化而变化。因此，我们可以将 $\\beta$ 视为一个函数：\n\n$$\n\\beta_i = \\alpha_2 + \\theta Z_i \\tag{4}\n$$\n\n此处，$Z$ 可以是一个变量，也可以是一组变量。用 (4) 式中的 $\\beta_i$ 替换 (2) 式中的 $\\beta$，我们得到变系数模型：\n\n$$\n\\begin{aligned}\nY_i &= \\alpha_1 + \\beta_i X_{i} + \\gamma W_{i} + \\varepsilon_i \\\\\n    &= \\alpha_1 + (\\alpha_2 + \\theta Z_i) X_{i} + \\gamma W_{i} + \\varepsilon_i \\\\\n    &= \\alpha_1 + \\alpha_2 X_{i} + \\theta Z_i X_{i} + \\gamma W_{i} + \\varepsilon_i \\tag{5}\n\\end{aligned}\n$$\n\n在 (5) 式中，$Z_i X_{i}$ 表示 $Z_i$ 和 $X_i$ 的交互项。通过这种方式，我们可以捕捉到 $X$ 对 $Y$ 的边际影响如何随着其他变量的变化而变化。\n\n需要说明的是，当 $Z=X$ 或 $Z = (X, X^2)$ 时，(5) 式中就会包含 $X$ 的平方项或更高次项，这样就可以捕捉到 $X$ 的非线性效应。\n\n\n### 数据拆分与模型评估\n\n数据拆分（Data-Splitting）是一种常用的模型评估方法。我们将数据集随机分为训练集（train）和测试集（test），通常比例为 80% : 20%。在训练集上拟合模型，并在测试集上评估模型的预测能力。这样可以有效避免模型过拟合，获得更真实的预测性能指标。\n\n本节将分别对基础模型（Basic Model）和灵活模型（Flexible Model）进行训练集内（in-sample）性能评估，包括 $R^2$、调整 $R^2$、MSE 及调整 MSE 等指标。\n\n接下来，我们对数据分别拟合基础模型和灵活模型，采用普通最小二乘法（OLS）进行估计：\n\n#### 使用 Lasso 重新估计灵活模型\n\n我们用 Lasso（最小绝对收缩与选择算子）方法，重新估计灵活模型（Flexible Model），而不是采用 ols。Lasso 是一种带惩罚项的回归方法，适用于 $p/n$ 不小的情形，可以有效降低模型复杂度。关于 Lasso 的理论介绍将在后续课程详细展开，这里我们将其作为“黑箱”预测工具进行尝试。\n\n我们在特征构造阶段依然使用 statsmodels 的 formula api，以保证变量处理的一致性；在模型估计阶段，采用 sklearn 的 Lasso，并通过交叉验证自动选择正则化参数。\n\n综合上述各项指标，灵活模型（Flexible Model）的表现略优于基础模型（Basic Model）。\n\n由于 $p/n$ 并不大，调整前后的各项指标差异不大。但如果 $p/n$ 较大，调整项的影响会更明显。此时，为了防止过拟合，我们通常会采用**数据拆分（data splitting）**等更通用的策略。下面将通过具体例子进行说明。\n\n## 数据拆分：样本外预测表现\n\n在前面分析了样本内拟合效果后，我们进一步评估模型在样本外（out-of-sample）的预测能力：\n\n- 使用测试集（testing sample）进行评估。对于测试集中的每个观测，利用训练集估计得到的参数预测其 $\\mathtt{wage}$（工资）；\n- 计算两种预测模型在测试集上的均方预测误差 $MSE_{test}$，即样本外均方误差。\n\n通过这种方式，可以更真实地反映模型的泛化能力，避免仅凭样本内拟合效果（如 $R^2$、$MSE$）对模型优劣做出过于乐观的判断。\n\n\n在基础模型中，$MSE_{test}$（样本外均方误差）与 $MSE_{sample}$（样本内均方误差）非常接近。\n\n在灵活模型（Flexible Model）设定下，样本外均方误差 $MSE_{test}$ 与样本内均方误差 $MSE_{sample}$ 的差距并不大。\n\n需要注意的是，$MSE_{test}$ 会随着数据拆分的不同而有所波动。因此，通常建议对多次数据拆分下的样本外 $MSE$ 取平均，以获得更稳健的评估结果。\n\n总体来看，基于样本外 $MSE$，采用 OLS 回归的基础模型（Basic Model）与灵活模型的预测表现相当，甚至基础模型略优。\n\n接下来，我们将在灵活模型中用 Lasso 回归替代 OLS 回归。需要强调的是，样本外 $MSE$ 也可以用于评估其他任意“黑箱”预测方法。最后，我们将比较 Lasso 回归与 OLS 回归在灵活模型下的预测表现。\n\n\n\n### 超灵活模型与过拟合\n\n从前面的结果来看，Lasso 与 OLS 的预测表现差异并不大，似乎没有充分理由一定要用 Lasso。为了更好地说明 Lasso 的优势，我们引入一个“超灵活模型”（extra flexible model），展示 OLS 在高维协变量下如何严重过拟合训练集（in-sample），而在测试集（out-of-sample）上表现很差。\n\n超灵活模型包含了大量变量及其交互项，极大地提升了模型复杂度。在这种设定下，OLS 可以在训练集上取得极高的 $R^2$，但由于模型过于贴合训练数据，导致泛化能力下降，测试集上的预测误差显著增大。这种现象就是典型的“过拟合”（overfitting）。\n\n相比之下，Lasso 通过引入惩罚项（正则化），自动筛选和收缩部分系数，有效抑制了过拟合问题。即使在高维协变量下，Lasso 依然能保持较好的样本外预测能力。因此，在变量维度较高或模型复杂度较大时，Lasso 等正则化方法具有明显优势。\n\n可以看到，当协变量维度很高时，简单的 OLS 回归会出现明显的过拟合现象：样本内（in-sample）拟合效果非常好，但样本外（out-of-sample）预测能力却大幅下降。\n\n与此对比，Lasso 方法表现如下：\n\n如上所示，惩罚回归模型（如 Lasso）能够有效缓解过拟合（overfitting）问题。\n\n- 在高维特征或模型复杂度较高的情况下，普通最小二乘法（OLS）往往会出现“样本内拟合很好、样本外预测很差”的现象，即过拟合。\n- 而引入惩罚项的回归方法（如 Lasso），通过对系数收缩和变量选择，能够提升模型的泛化能力，使得样本外 $Y$ 的预测表现更加稳健。\n\n因此，在 $X$ 维度较高或变量间存在多重共线性的实际应用中，Lasso 等正则化方法是防止过拟合、提升预测准确性的有效工具。\n","srcMarkdownNoYaml":"\n\n\n\n\n\n\n提示词：\n\n翻译为中文，讲义风格。为了符合中文表述喜欢，可以适当意译。\n关键变量，如 Y, X 都用 Latex 格式，即 $Y$, $X$\n所有圆括号都采用半角模式；\n中英文混排加空格。\n\nSource: Chernozhukov, V. & Hansen, C. & Kallus, N. & Spindler, M. & Syrgkanis, V. (**2024**): Applied Causal Inference Powered by ML and AI. [CausalML-book.org](https://causalml-book.org/); arXiv:2403.02467. [-PDF-](https://arxiv.org/pdf/2403.02467)，[Website](https://causalml-book.org/), [github](https://github.com/CausalAIBook/MetricsMLNotebooks) &rarr; [This Note](https://github.com/CausalAIBook/MetricsMLNotebooks/blob/main/PM1/python-ols-and-lasso-for-wage-prediction.ipynb) \n\n## 简介\n\n在劳动经济学中，一个核心问题是：工人的工资 $Y$ 由什么因素决定？虽然这是一个因果推断问题，但我们可以先从预测的角度进行分析。\n\n在下面的工资案例中，$Y$ 表示工人的（对数）小时工资，$X$ 是工人的特征向量，例如教育、工作经验、性别等。这里我们关注两个主要问题：\n\n* 如何利用与工作相关的特征（如教育和经验）更好地预测工资 $Y$？\n* 在其他工作相关特征 $X$ 相同的情况下，男性和女性工人的预测工资有何不同？\n\n本实验首先聚焦于回归分析和预测问题。\n\n## 数据说明\n\n本次分析的数据来源于 2015 年美国现行人口调查（CPS）三月补充调查。我们筛选了 25 至 64 岁的白人非西班牙裔个体，要求每年工作超过 50 周且每周工作时间超过 35 小时。排除了自雇人员、居住在集体宿舍的个体、军人、农业或私人家庭部门的个体，以及在收入和就业状态报告上存在不一致、变量有缺失或分配信息的观测，同时剔除了小时工资低于 3 的样本。\n\n我们关注的核心变量 $Y$，即（对数）小时工资率，是由年收入除以总工作小时数得到的。其中，总工作小时数等于每年工作周数乘以每周通常工作小时数。在分析中，我们还聚焦于未婚（从未结婚）工人。最终样本量为 $n=5150$。\n\n\n### 变量标签与变量解释\n\n下面列示了该数据集中每个变量的常用英文标签及中文解释说明。部分变量根据 CPS 典型设定和相关代码本推断并补充。\n\n\n| 变量名   | 英文标签                         | 中文解释                          |\n| -- | - | -- |\n| wage  | Hourly wage                  | 小时工资（美元）                      |\n| lwage | Log hourly wage              | 小时工资的对数                       |\n| sex   | Female (1=Female)            | 性别（女性=1，男性=0）                 |\n| shs   | <12 years of schooling       | 教育年限未满 12 年（未完成高中）            |\n| hsg   | High school graduate         | 高中毕业                          |\n| scl   | Some college                 | 大学肄业（上过大学但未获得学位）              |\n| clg   | College graduate             | 大学毕业（获得学士学位）                  |\n| ad    | Advanced degree              | 研究生学历（硕士或博士）                  |\n| mw    | Midwest region               | 美国中西部地区（居住地）                  |\n| so    | South region                 | 美国南部地区（居住地）                   |\n| we    | West region                  | 美国西部地区（居住地）                   |\n| ne    | Northeast region             | 美国东北地区（居住地）                   |\n| exp1  | Potential experience         | 潜在工作经验年数（age - education - 6） |\n| exp2  | Potential experience squared | 潜在工作经验年数的平方                   |\n| exp3  | Potential experience cubed   | 潜在工作经验年数的三次方                  |\n| exp4  | Potential experience^4       | 潜在工作经验年数的四次方                  |\n| occ   | Occupation code              | 职业代码（细分，通常为 3-5 位数）           |\n| occ2  | Major occupation group       | 职业大类代码（22 类）                  |\n| ind   | Industry code                | 行业代码（细分，通常为 3-5 位数）           |\n| ind2  | Major industry group         | 行业大类代码（22 类）                  |\n\n\n### 变量进一步解释和常见分组\n\n* **学历变量（shs, hsg, scl, clg, ad）**\n  这些是**互斥**的 dummy 变量，每个人只能属于其中一个。常见定义如下：\n\n  * `shs`: 小于高中毕业（未完成高中学业）\n  * `hsg`: 高中毕业但没有上过大学\n  * `scl`: 上过大学但未毕业（包括两年制大学、部分大学课程等，未获得学位）\n  * `clg`: 获得学士学位（本科毕业）\n  * `ad`: 获得更高学位（硕士及以上）\n\n* **地区变量（mw, so, we, ne）**\n  根据居住地划分的美国四大区域，具体可以参考美国人口调查标准地区定义。\n\n* **经验变量（exp1, exp2, exp3, exp4）**\n  经验变量通常由公式 $exp1 = \\text{age} - \\text{years of schooling} - 6$ 计算，近似代表进入劳动力市场的年数，其高次项常用于工资方程中的经验-工资非线性关系建模。\n\n* **职业/行业变量（occ, occ2, ind, ind2）**\n\n  * `occ`/`ind` 为细分的职业/行业代码，通常来自于 CPS 的详细分类。\n  * `occ2`/`ind2` 则为大类分组，便于建模和控制大类异质性。\n\n\n### 参考说明与代码本依据\n\n这些变量的定义可参考 CPS（Current Population Survey）文档和相关学术论文，例如：\n\n- Angrist, J. D., & Pischke, J.-S. (2009). *Mostly Harmless Econometrics: An Empiricist's Companion*. Princeton University Press. [Link](https://press.princeton.edu/books/paperback/9780691120355/mostly-harmless-econometrics), [Google](https://scholar.google.com/scholar?q=Mostly+Harmless+Econometrics).\n- Card, D., & Krueger, A. B. (1992). School Quality and Black-White Relative Earnings: A Direct Assessment. *Quarterly Journal of Economics*, 107(1), 151–200. [Link](https://doi.org/10.2307/2118323), [PDF](http://sci-hub.ren/10.2307/2118323), [Google](https://scholar.google.com/scholar?q=School+Quality+and+Black-White+Relative+Earnings).\n\n\n### 相关 R/Python 代码标签举例\n\n常见的学历 dummies 在原始代码中的构造（R/Python 通用思路）：\n\n```python\n# Python 示意\ndf[\"shs\"] = (df[\"educ\"] < 12).astype(int)\ndf[\"hsg\"] = (df[\"educ\"] == 12).astype(int)\ndf[\"scl\"] = ((df[\"educ\"] > 12) & (df[\"educ\"] < 16)).astype(int)\ndf[\"clg\"] = (df[\"educ\"] == 16).astype(int)\ndf[\"ad\"] = (df[\"educ\"] > 16).astype(int)\n```\n\n\n## 基本数据分析\n\n本节将对数据进行初步分析，包括：\n\n- 生成一些新变量，以便于后续分组绘图；\n- 探索性数据分析：采用散点图、箱线图、小提琴图等可视化工具，分析工资在不同子样本 (不同教育水平、不同地区、不同性别等) 下的分布情况，以便初步了解工资与各个特征之间的关系；\n- 计算工资的描述性统计量（均值、中位数、标准差等）；\n- 采用分仓散点图和回归线，分析工资与潜在工作经验之间的关系。\n\n\n### 变量生成及变量标签\n\n在本节中，我们将对数据集进行变量生成和标签定义，以便后续分析和建模。\n\n- 基于 sex 生成新变量：带标签的变量 sex_label\n  - `sex_label`：{0: Male; 1: Female}，表示性别。我们将其转换为字符串标签。\n\n- 教育水平和地区\n  - 定义一个新变量：edu_group，表示教育水平的分组，取值为 `{'shs': '<HS', 'hsg': 'HS', 'scl': 'Some College', 'clg': 'College', 'ad': 'Advanced'}`。后续分析中采用这个变量更便于分组绘图和统计分析。\n  - 定义一个新变量：regeion，表示居住地区的分组，取值为 `{'mw': 'Midwest', 'so': 'South', 'we': 'West', 'ne': 'Northeast'}`。后续分析中采用这个变量更便于分组绘图和统计分析。\n\n\n### 不同职业类别的工资分布\n\n### 不同行业类别的工资分布\n\n## 不同教育水平的工资分布\n\n使用 `edu_group` 变量绘制不同教育水平的工资分布图。可以使用箱线图（boxplot）或小提琴图（violin plot）来展示不同教育水平下工资的分布情况。\n\n::: {.callout-tip}\n### 提示词\n使用 `edu_group` 变量绘制不同教育水平的工资分布图：\n\n- 小提琴图：颜色-深黄色；\n- 纵轴刻度：0(5)100；\n- Sample: wage < 100；\n- 添加浅灰色横向网格线，间隔 5\n\n:::\n\n\n### 箱线图：不同教育水平的工资分布\n\n### 不同教育水平下的工资性别差异\n\n::: {.callout-tip}\n### 提示词\n在每个教育水平组内，进一步区分 Male 和 Female，绘制箱线图。\n- 箱线图箱体填充色 Male: 深蓝色；Female：金黄色\n- legend：放在左上角\n- y 轴范围：0(10)80\n:::\n\n按区域和性别来展示工资的箱线图。\n\n- 首先，根据地区（region）和性别（sex）将原始数据 `df` 转换成长格式 `long_df_region`，便于后续分组绘图。\n- 接着，利用 seaborn 的 `boxplot` 和 `stripplot`，分别绘制了不同地区和性别组合下工资（`wage` 或 `lwage`）的箱线图和散点分布。\n\n\n### 不同地区的工资分布\n\n::: {.callout-tip}\n### 提示词\n\n1. 使用 `region` 变量绘制不同地区 Male 和 Female 的工资分布图：\n2. 箱线图 + 散点图\n3. 箱线图：无需填充箱体颜色\n   - 边框颜色：Male-深蓝色；Female-深黄色；\n   - 纵轴刻度：0(5)100；添加浅灰色横向网格线\n   - Sample: wage < 100；\n4. 散点：Male-深蓝色；Female-深黄色；透明度：0.18\n5. legend: 能区分 Male 和 Female 即可 \n\n:::\n\n简要分析：\n\n- 男性和女性在不同地区的工资分布存在明显差异，尤其是在 '中西部 (Midwest)' 和 '西部 (West)' 地区，男性的工资中位数普遍高于女性。不过，这种工资的性别差异相比于教育水平的差异要小得多。\n- 在 '南部 (South)'，男性和女性的工资分布较为接近。\n- 在 '东北部 (Northeast)'，女性的工资甚至略高于男性。\n\n### 组间均值差异检验\n\n在实际经济与社会数据分析中，我们经常需要比较两个不同群体（如男性与女性、实验组与对照组、不同地区等）的平均水平是否存在统计学上的显著差异。例如，在本例中，我们关注 Midwest 区域男性与女性的平均工资是否不同。这一问题本质上属于**组间均值差异检验**。\n\n#### 检验思路\n\n假设有两组独立观测值 $X_{1,1}, ..., X_{1,n_1}$（如男性工资）与 $X_{2,1}, ..., X_{2,n_2}$（如女性工资），我们关注这两组样本的均值是否存在显著差异。统计学上，常用的检验方法是**两独立样本 t 检验**。\n\n* **原假设**（$H_0$）：两组总体均值相等，即 $ \\mu_1 = \\mu_2 $\n* **备择假设**（$H_1$）：两组总体均值不等，即 $ \\mu_1 \\neq \\mu_2 $\n\n#### t 统计量的构建与分布\n\n假设两组观测值独立，且服从正态分布。若不假定两组方差相等（更贴合实际），则采用 Welch t 检验，t 统计量的计算公式为：\n\n$$\nt = \\frac{ \\bar{X}_1 - \\bar{X}_2 }{ \\sqrt{ \\frac{S_1^2}{n_1} + \\frac{S_2^2}{n_2} } } \\sim t(k)\n$$\n\n其中：\n\n* $ \\bar{X}_1, \\bar{X}_2 $ 为两组样本均值\n* $ S_1^2, S_2^2 $ 为两组样本方差\n* $ n_1, n_2 $ 为两组样本容量\n\n自由度为\n\n$$\nk = \\frac{ \\left( \\frac{S_1^2}{n_1} + \\frac{S_2^2}{n_2} \\right)^2 }{ \\frac{ (S_1^2 / n_1)^2 }{ n_1 - 1 } + \\frac{ (S_2^2 / n_2)^2 }{ n_2 - 1 } }\n$$\n\n在 $H_0$ 成立的前提下，t 统计量服从自由度为 $k$ 的 t 分布（即 Welch–Satterthwaite 近似）。若两组样本方差相等，则简化为标准的 t 检验，即 \n\n$$\nt = \\frac{ \\bar{X}_1 - \\bar{X}_2 }{ \\sqrt{ \\frac{S^2}{n_1} + \\frac{S^2}{n_2} } } \\sim t(n_1 + n_2 - 2)\n$$\n\n\n#### 显著性判别\n\n* 计算得到的 t 统计量越大，说明两组样本均值差异越显著。\n* 通过查找 t 分布的分位点或直接计算 P 值，判断观察到的样本均值差异出现的概率有多大。\n* 若 P 值小于设定的显著性水平（如 0.05），则拒绝原假设，认为两组均值存在显著差异。\n\n\n::: {.callout-tip}\n### 提示词\n\n采用 t-test 检验 Midwest 区域的 Male 和 Female 的平均工资是否存在显著差异。\n:::\n\n### 组间均值差异检验：多组比较\n\n::: {.callout-tip}\n### 提示词\n\n1. 目的：用于检验多个组内 (如 edu_group 或 region) 的 Male 和 Female 的平均工资是否存在显著差异。\n2. 分别使用 `edu_group` 和 `region` 变量进行分组检验。\n3. 输出每个组的平均工资和 t-test 的结果。\n   - 列示：mean1, mean2, diff (小数点后保留一位有效数字); t-statistic, p-value (小数点后保留三位)\n   - 列明：采用极简方式，如 'Male', 'Female', 'diff', 't', 'p-value'\n4. 可以调用好用的包，提供尽可能简洁的代码\n:::\n\n## wage 与 experience 的关系\n\n- 绘制 wage 和 experience 的 '散点图+线性回归线 (+ 95% CI)' 图。\n- 绘制 wage 和 experience 的 '散点图+二次曲线拟合线 (+ 95% CI)' 图。(省略了)\n\n\n## 分仓散点图\n\n- 绘制 wage 和 experience 的 '分仓散点图 (binscatter)+线性回归线 (+ 95% CI)' 图。\n\n### 变量构造\n\n我们在本节中构造了输出变量 $Y$ 以及包含工人特征的特征矩阵 $Z$，这些特征均来源于原始数据集。\n\nFor the outcome variable (log) wage and a subset of the raw regressors, we calculate the empirical mean and other empirical measures to get familiar with the data.\n\n\n\n例如，我们样本中女性工人占比约为 44%（$sex=1$ 表示女性）。\n\n## 预测\n\n接下来，我们将构建一个关于小时（对数）工资 $Y$ 的预测规则，假设 $Y$ 与与工作相关的特征 $X$ 之间存在线性关系：\n\n$$\nY = \\beta' X + \\epsilon \\tag{1}\n$$\n\n我们的目标包括：\n\n* 利用工人的多种特征预测工资水平，包括：\n  - 教育水平（如高中毕业、大学毕业等）；\n  - 工作经验（如潜在工作经验）；\n  - 性别（男性或女性）；\n  - 居住地区（如中西部、南部等）。\n* 通过（调整后的）样本均方误差（MSE）、（调整后的）样本 $R^2$ 以及样本外的 MSE 和 $R^2$，评估模型的预测能力。\n  \n  - $MSE = \\frac{1}{n} \\sum_{i=1}^{n} (Y_i - \\hat{Y}_i)^2$，其中 $\\hat{Y}_i$ 是模型预测的工资；\n  \n  - $R^2 = 1 - \\frac{MSE}{\\text{Var}(Y)}$，其中 $\\text{Var}(Y)$ 是工资的样本方差。\n  - $\\bar{R}^2 = 1 - \\frac{(1-R^2)(n-1)}{n-k-1}$，其中 $k$ 是模型中使用的特征数量。\n  - 样本外的 MSE 和 $R^2$ 是将基于训练样本得到的系数估计值带入测试样本中计算而得。\n\n为实现上述目标，我们采用数据拆分（data splitting）的方法来衡量两种模型的预测效果：\n\n- 随机将数据集分为训练集和测试集（更复杂的做法如分层抽样可进一步提升效果，这里仅用最基础的随机拆分）；\n- 在训练集上估计基本模型和灵活模型的参数；\n- 在使用测试集前，先评估模型在训练集上的拟合表现。\n\n\n我们采用两种不同的预测模型设定：\n\n1. **基础模型（Basic Model）**：$X$ 包含一组原始解释变量（如性别、工作经验、学历虚拟变量、职业和行业虚拟变量、地区虚拟变量等）。\n\n2. **灵活模型（Flexible Model）**：$X$ 不仅包含基础模型中的所有原始解释变量，还加入了变量变换（如 ${exp}^2$、${exp}^3$ 等高次项）以及工作经验与其他解释变量的两两交互项。例如，“工作经验 × 大学学历指示变量”就是一种典型的交互项。\n\n采用**灵活模型**可以用更复杂的回归函数来逼近真实关系，从而降低偏差。灵活模型拓展了回归函数的可能形状范围。一般来说，灵活模型往往能带来更高的预测准确性，但模型解释性会变弱。\n\n我们也可以将灵活模型视为「变系数模型」，具体说明如下。\n\n假设基础模型设定如下：\n\n$$\nY_i = \\alpha_1 + \\beta X_{i} + \\gamma W_{i} + \\varepsilon_i \\tag{2}\n$$\n\n其中 $X_i$ 是一组原始解释变量，$W_i$ 是一组控制变量。$X$ 对 $Y$ 的边际影响可以表示为：\n\n$$\n\\frac{\\partial Y_i}{\\partial X_i} = \\beta  \\tag{3}\n$$\n\n在基础模型中，$\\beta$ 是一个常数，表示 $X$ 对 $Y$ 的边际影响是恒定的。然而，现实中，$X$ 对 $Y$ 的影响可能会随着其他变量（如工作经验、教育水平等）的变化而变化。因此，我们可以将 $\\beta$ 视为一个函数：\n\n$$\n\\beta_i = \\alpha_2 + \\theta Z_i \\tag{4}\n$$\n\n此处，$Z$ 可以是一个变量，也可以是一组变量。用 (4) 式中的 $\\beta_i$ 替换 (2) 式中的 $\\beta$，我们得到变系数模型：\n\n$$\n\\begin{aligned}\nY_i &= \\alpha_1 + \\beta_i X_{i} + \\gamma W_{i} + \\varepsilon_i \\\\\n    &= \\alpha_1 + (\\alpha_2 + \\theta Z_i) X_{i} + \\gamma W_{i} + \\varepsilon_i \\\\\n    &= \\alpha_1 + \\alpha_2 X_{i} + \\theta Z_i X_{i} + \\gamma W_{i} + \\varepsilon_i \\tag{5}\n\\end{aligned}\n$$\n\n在 (5) 式中，$Z_i X_{i}$ 表示 $Z_i$ 和 $X_i$ 的交互项。通过这种方式，我们可以捕捉到 $X$ 对 $Y$ 的边际影响如何随着其他变量的变化而变化。\n\n需要说明的是，当 $Z=X$ 或 $Z = (X, X^2)$ 时，(5) 式中就会包含 $X$ 的平方项或更高次项，这样就可以捕捉到 $X$ 的非线性效应。\n\n\n### 数据拆分与模型评估\n\n数据拆分（Data-Splitting）是一种常用的模型评估方法。我们将数据集随机分为训练集（train）和测试集（test），通常比例为 80% : 20%。在训练集上拟合模型，并在测试集上评估模型的预测能力。这样可以有效避免模型过拟合，获得更真实的预测性能指标。\n\n本节将分别对基础模型（Basic Model）和灵活模型（Flexible Model）进行训练集内（in-sample）性能评估，包括 $R^2$、调整 $R^2$、MSE 及调整 MSE 等指标。\n\n接下来，我们对数据分别拟合基础模型和灵活模型，采用普通最小二乘法（OLS）进行估计：\n\n#### 使用 Lasso 重新估计灵活模型\n\n我们用 Lasso（最小绝对收缩与选择算子）方法，重新估计灵活模型（Flexible Model），而不是采用 ols。Lasso 是一种带惩罚项的回归方法，适用于 $p/n$ 不小的情形，可以有效降低模型复杂度。关于 Lasso 的理论介绍将在后续课程详细展开，这里我们将其作为“黑箱”预测工具进行尝试。\n\n我们在特征构造阶段依然使用 statsmodels 的 formula api，以保证变量处理的一致性；在模型估计阶段，采用 sklearn 的 Lasso，并通过交叉验证自动选择正则化参数。\n\n综合上述各项指标，灵活模型（Flexible Model）的表现略优于基础模型（Basic Model）。\n\n由于 $p/n$ 并不大，调整前后的各项指标差异不大。但如果 $p/n$ 较大，调整项的影响会更明显。此时，为了防止过拟合，我们通常会采用**数据拆分（data splitting）**等更通用的策略。下面将通过具体例子进行说明。\n\n## 数据拆分：样本外预测表现\n\n在前面分析了样本内拟合效果后，我们进一步评估模型在样本外（out-of-sample）的预测能力：\n\n- 使用测试集（testing sample）进行评估。对于测试集中的每个观测，利用训练集估计得到的参数预测其 $\\mathtt{wage}$（工资）；\n- 计算两种预测模型在测试集上的均方预测误差 $MSE_{test}$，即样本外均方误差。\n\n通过这种方式，可以更真实地反映模型的泛化能力，避免仅凭样本内拟合效果（如 $R^2$、$MSE$）对模型优劣做出过于乐观的判断。\n\n\n在基础模型中，$MSE_{test}$（样本外均方误差）与 $MSE_{sample}$（样本内均方误差）非常接近。\n\n在灵活模型（Flexible Model）设定下，样本外均方误差 $MSE_{test}$ 与样本内均方误差 $MSE_{sample}$ 的差距并不大。\n\n需要注意的是，$MSE_{test}$ 会随着数据拆分的不同而有所波动。因此，通常建议对多次数据拆分下的样本外 $MSE$ 取平均，以获得更稳健的评估结果。\n\n总体来看，基于样本外 $MSE$，采用 OLS 回归的基础模型（Basic Model）与灵活模型的预测表现相当，甚至基础模型略优。\n\n接下来，我们将在灵活模型中用 Lasso 回归替代 OLS 回归。需要强调的是，样本外 $MSE$ 也可以用于评估其他任意“黑箱”预测方法。最后，我们将比较 Lasso 回归与 OLS 回归在灵活模型下的预测表现。\n\n\n\n### 超灵活模型与过拟合\n\n从前面的结果来看，Lasso 与 OLS 的预测表现差异并不大，似乎没有充分理由一定要用 Lasso。为了更好地说明 Lasso 的优势，我们引入一个“超灵活模型”（extra flexible model），展示 OLS 在高维协变量下如何严重过拟合训练集（in-sample），而在测试集（out-of-sample）上表现很差。\n\n超灵活模型包含了大量变量及其交互项，极大地提升了模型复杂度。在这种设定下，OLS 可以在训练集上取得极高的 $R^2$，但由于模型过于贴合训练数据，导致泛化能力下降，测试集上的预测误差显著增大。这种现象就是典型的“过拟合”（overfitting）。\n\n相比之下，Lasso 通过引入惩罚项（正则化），自动筛选和收缩部分系数，有效抑制了过拟合问题。即使在高维协变量下，Lasso 依然能保持较好的样本外预测能力。因此，在变量维度较高或模型复杂度较大时，Lasso 等正则化方法具有明显优势。\n\n可以看到，当协变量维度很高时，简单的 OLS 回归会出现明显的过拟合现象：样本内（in-sample）拟合效果非常好，但样本外（out-of-sample）预测能力却大幅下降。\n\n与此对比，Lasso 方法表现如下：\n\n如上所示，惩罚回归模型（如 Lasso）能够有效缓解过拟合（overfitting）问题。\n\n- 在高维特征或模型复杂度较高的情况下，普通最小二乘法（OLS）往往会出现“样本内拟合很好、样本外预测很差”的现象，即过拟合。\n- 而引入惩罚项的回归方法（如 Lasso），通过对系数收缩和变量选择，能够提升模型的泛化能力，使得样本外 $Y$ 的预测表现更加稳健。\n\n因此，在 $X$ 维度较高或变量间存在多重共线性的实际应用中，Lasso 等正则化方法是防止过拟合、提升预测准确性的有效工具。\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"wrap","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":true,"highlight-style":"atom-one","css":["../styles.css"],"output-file":"regress_02_wage.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.39","editor":"visual","theme":"cosmo","linestretch":1.6,"fontsize":"11.5pt","highlight":true,"callout-appearance":"default","md-extensions":["callout"],"includes":{"after-body":"../_includes/counter.html"},"title":"线性回归分析"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}