{"title":"案例：美国失业率和通胀率关系分析","markdown":{"yaml":{"title":"案例：美国失业率和通胀率关系分析"},"headingText":"下载美国失业率数据","containsRefs":false,"markdown":"\n\n\n\n\n本讲以 `pandas_datareader` 为例，介绍如何获取宏观数据，以及时间序列的基本特征和分析流程。\n\nFRED 是美国联邦储备银行提供的宏观经济数据，包含了大量的经济指标。\nFRED 提供了一个 API 接口，可以通过 `pandas_datareader` 来获取数据。\n\n本文写作过程中借助了 AI，包括 ChatGPT ([提示词](https://chatgpt.com/share/6818e458-538c-8005-9af1-1a8c31ee50f1)) 和 Github Coplilot。\n\n\n\n\n> Source: U.S. Bureau of Labor Statistics, Unemployment Rate [UNRATE], retrieved from FRED, Federal Reserve Bank of St. Louis; <https://fred.stlouisfed.org/series/UNRATE>, May 5, 2025. \n\n## 美国失业率的时序特征\n\n上图展示了自 1960 年以来美国的月度失业率变化趋势。总体来看，美国失业率呈现出显著的**周期性波动**，其高峰通常与经济衰退期相吻合，低谷则出现在经济扩张阶段。\n\n- **周期波动明显**：失业率大致每 8-10 年出现一次较大波动，与美国历次经济衰退（如 1974、1982、1991、2008 和 2020 年）高度对应。\n- **历史极值**：2020 年新冠疫情爆发初期，失业率迅速飙升至超过 14%，为图中最高点，反映出突发公共卫生事件对劳动市场的巨大冲击。\n- **长期下行趋势**：尽管存在周期性波动，但在部分阶段（如 1982-2000 年间、2010-2019 年间）可观察到失业率逐步下降的趋势，显示出结构性改善可能性。\n\n### 问题：如何分析失业率的时序特征？\n\n从图中失业率的走势出发，我们可以从以下几个角度提出计量建模中需要关注的核心问题：\n\n* **平稳性与周期性：**\n  失业率呈现一定的均值回复特征 (在上图中，均值约为 6Z%)，但是否真正平稳？如何通过单位根检验（如 ADF 检验）判断？如果该序列非平稳，我们是否应进行差分处理以便后续建模？\n\n* **结构性突变：**\n  例如 2020 年的断崖式上升显然并非常态波动，这提示我们应考虑模型中可能存在的**结构突变（structural break）**。在传统 ARIMA 模型之外，我们可能需要引入 regime-switching 或 dummy 变量来捕捉这类异质性。\n\n* **滞后依赖结构：**\n  当前失业率是否受到过去若干期值的影响？其滞后项在建模中如何体现？这正是 AR(p) 或 ARMA(p, q) 模型关注的核心。\n\n* **长期关系与协整：**\n  若将失业率与其他宏观变量（如通货膨胀率、GDP 增长率）联合考虑，它们之间是否存在协整关系？若存在，应如何建立误差修正模型（ECM）？\n\n* **波动性建模：**\n  某些阶段的波动显著大于其他时期，例如 1970s 或 2008 危机期间。如何刻画这种**条件异方差**特征？这将引出 ARCH/GARCH 及其扩展模型的讨论。\n\n\n### 10 年移动平均\n\n我们可以使用 `rolling` 函数来计算 10 年移动平均，以便从更长时间尺度上观察失业率的变化趋势。\n\n\n## 消费者物价指数（CPI）\n\n> Source: U.S. Bureau of Labor Statistics, Consumer Price Index for All Urban Consumers: All Items in U.S. City Average, Not Seasonally Adjusted [CPIAUCNS], retrieved from FRED, Federal Reserve Bank of St. Louis; <https://fred.stlouisfed.org/series/CPIAUCNS>, May 5, 2025.\n\n### 美国消费者物价指数（CPI）趋势图解读\n\n上图展示了自 1960 年以来美国城市居民的消费者物价指数（CPI-U）的长期变化趋势，数据来自 FRED 数据库，基期设为 1982-1984 年的平均水平（指数 = 100）。\n\n从图中可以观察到以下几个重要特征：\n\n* **总体呈上升趋势**：说明过去几十年美国总体价格水平持续上升，具有显著的通货膨胀特征。\n* **1970s 的急剧上升**：受石油危机影响，1970 年代出现了显著的高通胀，CPI 增速明显加快。\n* **1980s 以后趋于稳定增长**：随着货币政策收紧（如沃尔克加息），通胀得到控制，CPI 增长变得更加平缓。\n* **2020 年以后的陡峭上升**：反映出疫情后期以及地缘政治冲击下，美国面临新一轮较高通胀压力，物价上涨速度明显加快。\n\n接下来，我们可以看看最近 10-20 年的 CPI 变化趋势。\n\n## 失业率和通货膨胀率的关系\n\n接下来，我们将失业率和通货膨胀率结合起来，分析它们之间的关系。我们可以使用 `pandas` 和 `matplotlib` 来绘制散点图和线性回归线，以便更好地理解它们之间的关系。\n\n这幅图展示了 1960 年至今美国 **失业率（Unemployment Rate）** 与 **通胀率（Inflation Rate）** 的时间序列走势。可以从以下几个方面进行解读：\n\n* **趋势与波动性差异**：\n\n  * 失业率（蓝线）表现出相对平稳的周期性波动，具有一定的周期长度；\n  * 通胀率（绿线）波动幅度更大，尤其在 1970s 至 1980s 初期，有显著的尖峰。\n\n* **结构性事件的影响**：\n\n  * 1970s：石油危机期间，通胀迅速上升至 13% 以上（即“滞涨”现象），而失业率也居高不下；\n  * 2008 金融危机：失业率大幅上升，而通胀保持较低水平；\n  * 2020 疫情冲击：失业率暴涨，通胀短暂回落，随后于 2021-2022 再次激增。\n\n* **负相关性阶段**：\n\n  * 在部分阶段（例如 1980s 中后期、1990s、2010s），通胀与失业呈现出某种程度的负相关，符合传统的菲利普斯曲线（Phillips Curve）设定。\n\n\n### 建模思路\n\n如果我们想建立一个模型来刻画失业率与通胀率之间的关系，有哪些可行的建模思路呢？\n\n- 线性回归\n- ARMA 模型\n- VAR 模型\n- VECM 模型\n\n## 线性回归模型\n\n## 单变量分析\n\n我们先采用 ARMA 模型来分析失业率和通货膨胀率的单变量特征。进而使用单位根检验（如 ADF 检验）来判断序列的平稳性。\n在下一小节中，将采用 VAR 模型来分析失业率和通货膨胀率的关系。\n\n### ARMA(1,1) 模型\n\n$$y_t = \\alpha + \\beta y_{t-1} + \\epsilon_t + \\theta \\epsilon_{t-1}$$\n\n其中，$\\epsilon_t \\sim N(0, \\sigma^2)$。\n\n我们可以使用 `statsmodels` 库，分别针对失业率序列和通货膨胀序列来拟合 ARMA 模型。\n\n### 单位根检验\n\n从上面的 $ARMA(1,1)$ 模型的结果来看，$AR(1)$ 系数的估计值为 $0.9847$，接近于 $1$，这表明该序列可能是一个单位根序列。\n\n我们可以使用 `statsmodels` 库中的 `adfuller` 函数来进行单位根检验。\n\n#### ADF 检验\n给定一个时间序列 $X_t$，我们可以使用以下的 ADF 检验来检验 $X_t$ 是否是平稳的：\n\n$$\nX_t = \\phi_0 + \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + ... + \\phi_p X_{t-p} + \\epsilon_t$$\n\n其中，$\\epsilon_t$ 是一个白噪声序列。\n\nADF 检验的原假设是：$X_t$ 是一个单位根序列，即 $H_0: \\phi_1 = 1$。\n如果 $H_0$ 被拒绝，则说明 $X_t$ 是平稳的。\n\nADF 检验包含几种典型的数据生成机制：\n\n- 纯随机游走：$X_t = X_{t-1} + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列。\n- 随机游走加趋势：$X_t = \\phi_0 + \\phi_1 X_{t-1} + \\phi_2 t + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列，$t$ 是时间趋势项。\n- 随机游走加季节性：$X_t = \\phi_0 + \\phi_1 X_{t-1} + S_t + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列，$S_t$ 是季节性项。\n- 随机游走加趋势和季节性：$X_t = \\phi_0 + \\phi_1 X_{t-1} + \\phi_2 t + S_t + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列，$t$ 是时间趋势项，$S_t$ 是季节性项。\n\n#### KPSS 检验\nKPSS 检验的原假设是：$X_t$ 是平稳的，即 $H_0: \\phi_1 < 1$。\n如果 $H_0$ 被拒绝，则说明 $X_t$ 是一个单位根序列。\n\n#### PP 检验\nPP 检验的原假设是：$X_t$ 是一个单位根序列，即 $H_0: \\phi_1 = 1$。\n如果 $H_0$ 被拒绝，则说明 $X_t$ 是平稳的。\n\n解读：\n上面的图形展示了美国失业率和通货膨胀率的时间序列变化趋势。可以观察到，失业率和通货膨胀率在不同时间段内呈现出一定的波动性。失业率在经济衰退期间通常会显著上升，而通货膨胀率则可能受到多种因素的影响，包括货币政策、供需变化等。通过对比两条曲线，可以进一步分析它们之间的关系，例如是否存在菲利普斯曲线的特征。此外，结合回归分析和相关系数的计算结果，可以定量评估失业率与通货膨胀率之间的相关性。\n\n## VAR 模型\n\n向量自回归模型（Vector Autoregression, VAR）是一种多元时间序列模型，用于捕捉多个变量之间的动态关系。它假设每个变量不仅受自身滞后值的影响，还受到其他变量滞后值的影响。\n\n### VAR(2) 模型的形式\n\n以两个变量 $y_t$ 和 $x_t$ 为例，VAR(2) 模型的形式如下：\n\n$$\n\\begin{aligned}\ny_t &= a_{10} + a_{11} y_{t-1} + a_{12} x_{t-1} + a_{13} y_{t-2} + a_{14} x_{t-2} + \\epsilon_{y,t}, \\\\\nx_t &= a_{20} + a_{21} y_{t-1} + a_{22} x_{t-1} + a_{23} y_{t-2} + a_{24} x_{t-2} + \\epsilon_{x,t},\n\\end{aligned}\n$$\n\n其中：\n\n- $y_t$ 和 $x_t$ 是两个时间序列变量；\n- $a_{ij}$ 是模型系数；\n- $\\epsilon_{y,t}$ 和 $\\epsilon_{x,t}$ 是误差项，通常假设为白噪声。\n\n### VAR(P) 模型的扩展\n\nVAR(P) 模型是 VAR(2) 模型的推广形式，表示包含 $P$ 阶滞后项的向量自回归模型。其一般形式为：\n\n$$\nY_t = A_1 Y_{t-1} + A_2 Y_{t-2} + \\dots + A_P Y_{t-P} + \\epsilon_t,\n$$\n\n其中：\n\n- $Y_t$ 是包含多个变量的向量（如 $[y_t, x_t]^\\top$）；\n- $A_1, A_2, \\dots, A_P$ 是系数矩阵；\n- $\\epsilon_t$ 是误差项。\n\n通过增加滞后阶数 $P$，VAR 模型可以捕捉更复杂的动态关系，但也可能导致参数过多的问题。因此，选择合适的滞后阶数是建模中的关键步骤。\n\n### VAR 模型的估计\n\n在 VAR 模型中，估计的核心任务是确定模型的滞后阶数，并对模型参数进行估计。以下是 VAR 模型估计的主要步骤：\n\n1. 数据准备：确保时间序列数据是平稳的。如果数据非平稳，可以通过差分或其他变换使其平稳。\n1. 滞后阶数选择：通过信息准则（如 AIC、BIC、HQIC）选择合适的滞后阶数，避免过拟合。\n1. 模型估计：使用最小二乘法（OLS）对 VAR 模型的参数进行估计，逐个方程独立估计。\n1. 模型诊断：检查残差是否存在自相关、异方差等问题，必要时调整模型或采用其他方法改进。\n\n接下来，我们用 `statsmodels` 库来估计 VAR 模型，分析失业率和通货膨胀率之间的动态关系。\n\n首先，需要进行模型，最核心的问题是确定滞后阶数。\n\n由此可以看出，我们设定一个 VAR(2) 模型即可。\n\n\n根据 VAR（向量自回归）模型的估计结果，可以对失业率与通货膨胀率之间的动态相关关系进行如下简要解释：\n\n1. 模型设定与解释：本模型包含两个内生变量：**Unemployment Rate（失业率）** 与 **Inflation Rate（通货膨胀率）**，并引入了两个滞后期，用以捕捉二者的动态交互关系。\n\n2. 失业率方程\n   - **L1.Inflation Rate 的系数为 -0.104，且在 1% 显著水平下显著**（p = 0.010），表明通货膨胀率上期上升，会导致当期失业率下降，呈现出负相关关系。这种现象与传统的菲利普斯曲线一致，即短期内存在“以通胀换就业”的机制。\n   - **L2.Inflation Rate 的系数为 +0.118，同样显著（p = 0.003）**，意味着这种负向冲击在第二期发生一定反转，提示通胀与失业的关系可能并非单调，而具有一定的动态调整路径。\n   - **失业率自身具有较强的惯性**（L1 系数为 0.988，p < 0.001），说明其变化趋于缓慢，当前水平很大程度由前一期决定。\n\n3. 通货膨胀率方程\n   - **Inflation Rate 的自回归项 L1 系数高达 1.342，显著性极强**（p < 0.001），说明通胀率具有高度的自我延续性，是一个强持久性的变量。\n   - **Unemployment Rate 的滞后项（L1 与 L2）在该方程中均不显著**（p 值远大于 0.1），表明失业率对通胀率的短期预测贡献较小。\n\n4. 残差相关矩阵：两个方程残差间的相关系数为 **-0.143**，为中等程度的负相关，意味着在控制了自身滞后影响后，**通胀与失业之间仍存在一定的即时负相关关系**。\n\n综上，**通胀率的变化对失业率存在短期的显著负向影响**，但 **失业率对通胀率的影响不明显**，两者关系具有方向性和滞后性，表现出一定的不对称特征。这一结果对政策制定者具有重要意义：在制定货币或财政政策以影响就业时，应特别关注通胀路径对失业的动态传导。\n\n\n### Granger 因果检验\n\nGranger 因果检验的核心思想是通过回归分析判断一个变量的滞后值是否能够显著提高对另一个变量的预测能力。以下是 Granger 因果检验的数学公式及其在失业率 $u$ 和通胀率 $e$ 上的应用。\n\n#### 1. 单变量回归模型\n首先，构建仅包含因变量自身滞后项的回归模型：\n$$\nu_t = \\alpha_0 + \\sum_{i=1}^p \\alpha_i u_{t-i} + \\epsilon_t\n$$\n其中：$u_t$ 表示当前的失业率；$u_{t-i}$ 表示失业率的第 $i$ 阶滞后值；$\\epsilon_t$ 是误差项。\n\n#### 2. 多变量回归模型\n然后，构建同时包含因变量和另一个变量滞后项的回归模型：\n\n$$\nu_t = \\beta_0 + \\sum_{i=1}^p \\beta_i u_{t-i} + \\sum_{j=1}^q \\gamma_j e_{t-j} + \\eta_t\n$$\n\n其中：$e_{t-j}$ 表示通胀率的第 $j$ 阶滞后值；$\\eta_t$ 是误差项。\n\n#### 3. 检验假设\n通过 F 检验比较上述两个模型的拟合优度，检验以下假设：\n\n- 原假设 $H_0$：$e_{t-j}$ 的系数 $\\gamma_j = 0$，即通胀率的滞后值对失业率没有显著影响；\n- 备择假设 $H_1$：$e_{t-j}$ 的系数 $\\gamma_j \\neq 0$，即通胀率的滞后值对失业率有显著影响。\n\n\n\n以下是基于失业率 $u$ 和通胀率 $e$ 的 Granger 因果检验代码示例：\n\n## 脉冲响应分析\n\n### 什么是脉冲响应分析？\n\n脉冲响应分析（Impulse Response Analysis）是时间序列分析中的一种重要工具，用于研究系统对外部冲击的动态反应。具体来说，在向量自回归模型（VAR）中，脉冲响应分析可以帮助我们回答以下问题：\n\n- 当某个变量受到一个单位冲击时，其他变量会如何反应？\n- 这种反应会持续多长时间？\n- 反应的方向和强度如何？\n\n### 数学定义\n\n假设我们有一个 $\\text{VAR}(p)$ 模型：\n\n$$\nY_t = A_1 Y_{t-1} + A_2 Y_{t-2} + \\dots + A_p Y_{t-p} + \\epsilon_t\n$$\n\n其中：\n\n- $Y_t$ 是包含多个变量的向量；\n- $A_i$ 是系数矩阵；\n- $\\epsilon_t$ 是误差项。\n\n脉冲响应函数（Impulse Response Function, IRF）描述了 $Y_t$ 中某个变量对 $\\epsilon_t$ 中某个分量的单位冲击的动态反应。\n\n### 分析步骤\n\n1. **拟合 VAR 模型**：首先需要对时间序列数据拟合一个 VAR 模型。\n2. **计算脉冲响应函数**：基于拟合的 VAR 模型，计算各变量对冲击的响应。\n3. **绘制脉冲响应图**：将响应结果可视化，便于直观理解。\n\n### 示例：失业率与通胀率的脉冲响应分析\n\n以下是基于失业率和通胀率的脉冲响应分析步骤：\n\n1. **拟合 VAR 模型**：我们已经拟合了一个 VAR(2) 模型。\n2. **计算脉冲响应函数**：使用 `statsmodels` 提供的工具计算脉冲响应。\n3. **绘制脉冲响应图**：展示失业率和通胀率对冲击的动态反应。\n\n\n以下是脉冲响应分析的代码示例：\n\n\n上面的图形展示了失业率和通货膨胀率的脉冲响应分析结果，具体解读如下：\n\n1. **失业率对自身冲击的响应**：\n    - 失业率在受到自身冲击后，短期内会出现显著的正向反应，随后逐渐回归到长期均衡水平。\n    - 这种现象表明失业率具有一定的惯性效应，即当前的失业率水平会受到过去水平的显著影响。\n\n2. **通货膨胀率对自身冲击的响应**：\n    - 通货膨胀率在受到自身冲击后，也会出现短期的正向反应，但其回归速度较快。\n    - 这表明通货膨胀率的波动性较高，但其长期趋势相对稳定。\n\n3. **失业率对通货膨胀率冲击的响应**：\n    - 失业率在受到通货膨胀率冲击后，可能会出现短暂的负向反应，随后逐渐回归均衡。\n    - 这种负相关性可能与菲利普斯曲线的理论一致，即在短期内失业率和通货膨胀率之间存在一定的替代关系。\n\n4. **通货膨胀率对失业率冲击的响应**：\n    - 通货膨胀率在受到失业率冲击后，反应较为温和，且回归速度较快。\n    - 这表明失业率的变化对通货膨胀率的长期影响较小，但可能会在短期内引发一定的波动。\n\n### 总结\n通过脉冲响应分析可以看出，失业率和通货膨胀率之间存在一定的动态关系，但这种关系在短期内更为显著，长期影响则趋于平稳。这为进一步的经济建模和政策分析提供了重要的参考依据。\n","srcMarkdownNoYaml":"\n\n\n\n\n本讲以 `pandas_datareader` 为例，介绍如何获取宏观数据，以及时间序列的基本特征和分析流程。\n\nFRED 是美国联邦储备银行提供的宏观经济数据，包含了大量的经济指标。\nFRED 提供了一个 API 接口，可以通过 `pandas_datareader` 来获取数据。\n\n本文写作过程中借助了 AI，包括 ChatGPT ([提示词](https://chatgpt.com/share/6818e458-538c-8005-9af1-1a8c31ee50f1)) 和 Github Coplilot。\n\n\n\n## 下载美国失业率数据\n\n> Source: U.S. Bureau of Labor Statistics, Unemployment Rate [UNRATE], retrieved from FRED, Federal Reserve Bank of St. Louis; <https://fred.stlouisfed.org/series/UNRATE>, May 5, 2025. \n\n## 美国失业率的时序特征\n\n上图展示了自 1960 年以来美国的月度失业率变化趋势。总体来看，美国失业率呈现出显著的**周期性波动**，其高峰通常与经济衰退期相吻合，低谷则出现在经济扩张阶段。\n\n- **周期波动明显**：失业率大致每 8-10 年出现一次较大波动，与美国历次经济衰退（如 1974、1982、1991、2008 和 2020 年）高度对应。\n- **历史极值**：2020 年新冠疫情爆发初期，失业率迅速飙升至超过 14%，为图中最高点，反映出突发公共卫生事件对劳动市场的巨大冲击。\n- **长期下行趋势**：尽管存在周期性波动，但在部分阶段（如 1982-2000 年间、2010-2019 年间）可观察到失业率逐步下降的趋势，显示出结构性改善可能性。\n\n### 问题：如何分析失业率的时序特征？\n\n从图中失业率的走势出发，我们可以从以下几个角度提出计量建模中需要关注的核心问题：\n\n* **平稳性与周期性：**\n  失业率呈现一定的均值回复特征 (在上图中，均值约为 6Z%)，但是否真正平稳？如何通过单位根检验（如 ADF 检验）判断？如果该序列非平稳，我们是否应进行差分处理以便后续建模？\n\n* **结构性突变：**\n  例如 2020 年的断崖式上升显然并非常态波动，这提示我们应考虑模型中可能存在的**结构突变（structural break）**。在传统 ARIMA 模型之外，我们可能需要引入 regime-switching 或 dummy 变量来捕捉这类异质性。\n\n* **滞后依赖结构：**\n  当前失业率是否受到过去若干期值的影响？其滞后项在建模中如何体现？这正是 AR(p) 或 ARMA(p, q) 模型关注的核心。\n\n* **长期关系与协整：**\n  若将失业率与其他宏观变量（如通货膨胀率、GDP 增长率）联合考虑，它们之间是否存在协整关系？若存在，应如何建立误差修正模型（ECM）？\n\n* **波动性建模：**\n  某些阶段的波动显著大于其他时期，例如 1970s 或 2008 危机期间。如何刻画这种**条件异方差**特征？这将引出 ARCH/GARCH 及其扩展模型的讨论。\n\n\n### 10 年移动平均\n\n我们可以使用 `rolling` 函数来计算 10 年移动平均，以便从更长时间尺度上观察失业率的变化趋势。\n\n\n## 消费者物价指数（CPI）\n\n> Source: U.S. Bureau of Labor Statistics, Consumer Price Index for All Urban Consumers: All Items in U.S. City Average, Not Seasonally Adjusted [CPIAUCNS], retrieved from FRED, Federal Reserve Bank of St. Louis; <https://fred.stlouisfed.org/series/CPIAUCNS>, May 5, 2025.\n\n### 美国消费者物价指数（CPI）趋势图解读\n\n上图展示了自 1960 年以来美国城市居民的消费者物价指数（CPI-U）的长期变化趋势，数据来自 FRED 数据库，基期设为 1982-1984 年的平均水平（指数 = 100）。\n\n从图中可以观察到以下几个重要特征：\n\n* **总体呈上升趋势**：说明过去几十年美国总体价格水平持续上升，具有显著的通货膨胀特征。\n* **1970s 的急剧上升**：受石油危机影响，1970 年代出现了显著的高通胀，CPI 增速明显加快。\n* **1980s 以后趋于稳定增长**：随着货币政策收紧（如沃尔克加息），通胀得到控制，CPI 增长变得更加平缓。\n* **2020 年以后的陡峭上升**：反映出疫情后期以及地缘政治冲击下，美国面临新一轮较高通胀压力，物价上涨速度明显加快。\n\n接下来，我们可以看看最近 10-20 年的 CPI 变化趋势。\n\n## 失业率和通货膨胀率的关系\n\n接下来，我们将失业率和通货膨胀率结合起来，分析它们之间的关系。我们可以使用 `pandas` 和 `matplotlib` 来绘制散点图和线性回归线，以便更好地理解它们之间的关系。\n\n这幅图展示了 1960 年至今美国 **失业率（Unemployment Rate）** 与 **通胀率（Inflation Rate）** 的时间序列走势。可以从以下几个方面进行解读：\n\n* **趋势与波动性差异**：\n\n  * 失业率（蓝线）表现出相对平稳的周期性波动，具有一定的周期长度；\n  * 通胀率（绿线）波动幅度更大，尤其在 1970s 至 1980s 初期，有显著的尖峰。\n\n* **结构性事件的影响**：\n\n  * 1970s：石油危机期间，通胀迅速上升至 13% 以上（即“滞涨”现象），而失业率也居高不下；\n  * 2008 金融危机：失业率大幅上升，而通胀保持较低水平；\n  * 2020 疫情冲击：失业率暴涨，通胀短暂回落，随后于 2021-2022 再次激增。\n\n* **负相关性阶段**：\n\n  * 在部分阶段（例如 1980s 中后期、1990s、2010s），通胀与失业呈现出某种程度的负相关，符合传统的菲利普斯曲线（Phillips Curve）设定。\n\n\n### 建模思路\n\n如果我们想建立一个模型来刻画失业率与通胀率之间的关系，有哪些可行的建模思路呢？\n\n- 线性回归\n- ARMA 模型\n- VAR 模型\n- VECM 模型\n\n## 线性回归模型\n\n## 单变量分析\n\n我们先采用 ARMA 模型来分析失业率和通货膨胀率的单变量特征。进而使用单位根检验（如 ADF 检验）来判断序列的平稳性。\n在下一小节中，将采用 VAR 模型来分析失业率和通货膨胀率的关系。\n\n### ARMA(1,1) 模型\n\n$$y_t = \\alpha + \\beta y_{t-1} + \\epsilon_t + \\theta \\epsilon_{t-1}$$\n\n其中，$\\epsilon_t \\sim N(0, \\sigma^2)$。\n\n我们可以使用 `statsmodels` 库，分别针对失业率序列和通货膨胀序列来拟合 ARMA 模型。\n\n### 单位根检验\n\n从上面的 $ARMA(1,1)$ 模型的结果来看，$AR(1)$ 系数的估计值为 $0.9847$，接近于 $1$，这表明该序列可能是一个单位根序列。\n\n我们可以使用 `statsmodels` 库中的 `adfuller` 函数来进行单位根检验。\n\n#### ADF 检验\n给定一个时间序列 $X_t$，我们可以使用以下的 ADF 检验来检验 $X_t$ 是否是平稳的：\n\n$$\nX_t = \\phi_0 + \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + ... + \\phi_p X_{t-p} + \\epsilon_t$$\n\n其中，$\\epsilon_t$ 是一个白噪声序列。\n\nADF 检验的原假设是：$X_t$ 是一个单位根序列，即 $H_0: \\phi_1 = 1$。\n如果 $H_0$ 被拒绝，则说明 $X_t$ 是平稳的。\n\nADF 检验包含几种典型的数据生成机制：\n\n- 纯随机游走：$X_t = X_{t-1} + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列。\n- 随机游走加趋势：$X_t = \\phi_0 + \\phi_1 X_{t-1} + \\phi_2 t + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列，$t$ 是时间趋势项。\n- 随机游走加季节性：$X_t = \\phi_0 + \\phi_1 X_{t-1} + S_t + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列，$S_t$ 是季节性项。\n- 随机游走加趋势和季节性：$X_t = \\phi_0 + \\phi_1 X_{t-1} + \\phi_2 t + S_t + \\epsilon_t$，其中 $\\epsilon_t$ 是一个白噪声序列，$t$ 是时间趋势项，$S_t$ 是季节性项。\n\n#### KPSS 检验\nKPSS 检验的原假设是：$X_t$ 是平稳的，即 $H_0: \\phi_1 < 1$。\n如果 $H_0$ 被拒绝，则说明 $X_t$ 是一个单位根序列。\n\n#### PP 检验\nPP 检验的原假设是：$X_t$ 是一个单位根序列，即 $H_0: \\phi_1 = 1$。\n如果 $H_0$ 被拒绝，则说明 $X_t$ 是平稳的。\n\n解读：\n上面的图形展示了美国失业率和通货膨胀率的时间序列变化趋势。可以观察到，失业率和通货膨胀率在不同时间段内呈现出一定的波动性。失业率在经济衰退期间通常会显著上升，而通货膨胀率则可能受到多种因素的影响，包括货币政策、供需变化等。通过对比两条曲线，可以进一步分析它们之间的关系，例如是否存在菲利普斯曲线的特征。此外，结合回归分析和相关系数的计算结果，可以定量评估失业率与通货膨胀率之间的相关性。\n\n## VAR 模型\n\n向量自回归模型（Vector Autoregression, VAR）是一种多元时间序列模型，用于捕捉多个变量之间的动态关系。它假设每个变量不仅受自身滞后值的影响，还受到其他变量滞后值的影响。\n\n### VAR(2) 模型的形式\n\n以两个变量 $y_t$ 和 $x_t$ 为例，VAR(2) 模型的形式如下：\n\n$$\n\\begin{aligned}\ny_t &= a_{10} + a_{11} y_{t-1} + a_{12} x_{t-1} + a_{13} y_{t-2} + a_{14} x_{t-2} + \\epsilon_{y,t}, \\\\\nx_t &= a_{20} + a_{21} y_{t-1} + a_{22} x_{t-1} + a_{23} y_{t-2} + a_{24} x_{t-2} + \\epsilon_{x,t},\n\\end{aligned}\n$$\n\n其中：\n\n- $y_t$ 和 $x_t$ 是两个时间序列变量；\n- $a_{ij}$ 是模型系数；\n- $\\epsilon_{y,t}$ 和 $\\epsilon_{x,t}$ 是误差项，通常假设为白噪声。\n\n### VAR(P) 模型的扩展\n\nVAR(P) 模型是 VAR(2) 模型的推广形式，表示包含 $P$ 阶滞后项的向量自回归模型。其一般形式为：\n\n$$\nY_t = A_1 Y_{t-1} + A_2 Y_{t-2} + \\dots + A_P Y_{t-P} + \\epsilon_t,\n$$\n\n其中：\n\n- $Y_t$ 是包含多个变量的向量（如 $[y_t, x_t]^\\top$）；\n- $A_1, A_2, \\dots, A_P$ 是系数矩阵；\n- $\\epsilon_t$ 是误差项。\n\n通过增加滞后阶数 $P$，VAR 模型可以捕捉更复杂的动态关系，但也可能导致参数过多的问题。因此，选择合适的滞后阶数是建模中的关键步骤。\n\n### VAR 模型的估计\n\n在 VAR 模型中，估计的核心任务是确定模型的滞后阶数，并对模型参数进行估计。以下是 VAR 模型估计的主要步骤：\n\n1. 数据准备：确保时间序列数据是平稳的。如果数据非平稳，可以通过差分或其他变换使其平稳。\n1. 滞后阶数选择：通过信息准则（如 AIC、BIC、HQIC）选择合适的滞后阶数，避免过拟合。\n1. 模型估计：使用最小二乘法（OLS）对 VAR 模型的参数进行估计，逐个方程独立估计。\n1. 模型诊断：检查残差是否存在自相关、异方差等问题，必要时调整模型或采用其他方法改进。\n\n接下来，我们用 `statsmodels` 库来估计 VAR 模型，分析失业率和通货膨胀率之间的动态关系。\n\n首先，需要进行模型，最核心的问题是确定滞后阶数。\n\n由此可以看出，我们设定一个 VAR(2) 模型即可。\n\n\n根据 VAR（向量自回归）模型的估计结果，可以对失业率与通货膨胀率之间的动态相关关系进行如下简要解释：\n\n1. 模型设定与解释：本模型包含两个内生变量：**Unemployment Rate（失业率）** 与 **Inflation Rate（通货膨胀率）**，并引入了两个滞后期，用以捕捉二者的动态交互关系。\n\n2. 失业率方程\n   - **L1.Inflation Rate 的系数为 -0.104，且在 1% 显著水平下显著**（p = 0.010），表明通货膨胀率上期上升，会导致当期失业率下降，呈现出负相关关系。这种现象与传统的菲利普斯曲线一致，即短期内存在“以通胀换就业”的机制。\n   - **L2.Inflation Rate 的系数为 +0.118，同样显著（p = 0.003）**，意味着这种负向冲击在第二期发生一定反转，提示通胀与失业的关系可能并非单调，而具有一定的动态调整路径。\n   - **失业率自身具有较强的惯性**（L1 系数为 0.988，p < 0.001），说明其变化趋于缓慢，当前水平很大程度由前一期决定。\n\n3. 通货膨胀率方程\n   - **Inflation Rate 的自回归项 L1 系数高达 1.342，显著性极强**（p < 0.001），说明通胀率具有高度的自我延续性，是一个强持久性的变量。\n   - **Unemployment Rate 的滞后项（L1 与 L2）在该方程中均不显著**（p 值远大于 0.1），表明失业率对通胀率的短期预测贡献较小。\n\n4. 残差相关矩阵：两个方程残差间的相关系数为 **-0.143**，为中等程度的负相关，意味着在控制了自身滞后影响后，**通胀与失业之间仍存在一定的即时负相关关系**。\n\n综上，**通胀率的变化对失业率存在短期的显著负向影响**，但 **失业率对通胀率的影响不明显**，两者关系具有方向性和滞后性，表现出一定的不对称特征。这一结果对政策制定者具有重要意义：在制定货币或财政政策以影响就业时，应特别关注通胀路径对失业的动态传导。\n\n\n### Granger 因果检验\n\nGranger 因果检验的核心思想是通过回归分析判断一个变量的滞后值是否能够显著提高对另一个变量的预测能力。以下是 Granger 因果检验的数学公式及其在失业率 $u$ 和通胀率 $e$ 上的应用。\n\n#### 1. 单变量回归模型\n首先，构建仅包含因变量自身滞后项的回归模型：\n$$\nu_t = \\alpha_0 + \\sum_{i=1}^p \\alpha_i u_{t-i} + \\epsilon_t\n$$\n其中：$u_t$ 表示当前的失业率；$u_{t-i}$ 表示失业率的第 $i$ 阶滞后值；$\\epsilon_t$ 是误差项。\n\n#### 2. 多变量回归模型\n然后，构建同时包含因变量和另一个变量滞后项的回归模型：\n\n$$\nu_t = \\beta_0 + \\sum_{i=1}^p \\beta_i u_{t-i} + \\sum_{j=1}^q \\gamma_j e_{t-j} + \\eta_t\n$$\n\n其中：$e_{t-j}$ 表示通胀率的第 $j$ 阶滞后值；$\\eta_t$ 是误差项。\n\n#### 3. 检验假设\n通过 F 检验比较上述两个模型的拟合优度，检验以下假设：\n\n- 原假设 $H_0$：$e_{t-j}$ 的系数 $\\gamma_j = 0$，即通胀率的滞后值对失业率没有显著影响；\n- 备择假设 $H_1$：$e_{t-j}$ 的系数 $\\gamma_j \\neq 0$，即通胀率的滞后值对失业率有显著影响。\n\n\n\n以下是基于失业率 $u$ 和通胀率 $e$ 的 Granger 因果检验代码示例：\n\n## 脉冲响应分析\n\n### 什么是脉冲响应分析？\n\n脉冲响应分析（Impulse Response Analysis）是时间序列分析中的一种重要工具，用于研究系统对外部冲击的动态反应。具体来说，在向量自回归模型（VAR）中，脉冲响应分析可以帮助我们回答以下问题：\n\n- 当某个变量受到一个单位冲击时，其他变量会如何反应？\n- 这种反应会持续多长时间？\n- 反应的方向和强度如何？\n\n### 数学定义\n\n假设我们有一个 $\\text{VAR}(p)$ 模型：\n\n$$\nY_t = A_1 Y_{t-1} + A_2 Y_{t-2} + \\dots + A_p Y_{t-p} + \\epsilon_t\n$$\n\n其中：\n\n- $Y_t$ 是包含多个变量的向量；\n- $A_i$ 是系数矩阵；\n- $\\epsilon_t$ 是误差项。\n\n脉冲响应函数（Impulse Response Function, IRF）描述了 $Y_t$ 中某个变量对 $\\epsilon_t$ 中某个分量的单位冲击的动态反应。\n\n### 分析步骤\n\n1. **拟合 VAR 模型**：首先需要对时间序列数据拟合一个 VAR 模型。\n2. **计算脉冲响应函数**：基于拟合的 VAR 模型，计算各变量对冲击的响应。\n3. **绘制脉冲响应图**：将响应结果可视化，便于直观理解。\n\n### 示例：失业率与通胀率的脉冲响应分析\n\n以下是基于失业率和通胀率的脉冲响应分析步骤：\n\n1. **拟合 VAR 模型**：我们已经拟合了一个 VAR(2) 模型。\n2. **计算脉冲响应函数**：使用 `statsmodels` 提供的工具计算脉冲响应。\n3. **绘制脉冲响应图**：展示失业率和通胀率对冲击的动态反应。\n\n\n以下是脉冲响应分析的代码示例：\n\n\n上面的图形展示了失业率和通货膨胀率的脉冲响应分析结果，具体解读如下：\n\n1. **失业率对自身冲击的响应**：\n    - 失业率在受到自身冲击后，短期内会出现显著的正向反应，随后逐渐回归到长期均衡水平。\n    - 这种现象表明失业率具有一定的惯性效应，即当前的失业率水平会受到过去水平的显著影响。\n\n2. **通货膨胀率对自身冲击的响应**：\n    - 通货膨胀率在受到自身冲击后，也会出现短期的正向反应，但其回归速度较快。\n    - 这表明通货膨胀率的波动性较高，但其长期趋势相对稳定。\n\n3. **失业率对通货膨胀率冲击的响应**：\n    - 失业率在受到通货膨胀率冲击后，可能会出现短暂的负向反应，随后逐渐回归均衡。\n    - 这种负相关性可能与菲利普斯曲线的理论一致，即在短期内失业率和通货膨胀率之间存在一定的替代关系。\n\n4. **通货膨胀率对失业率冲击的响应**：\n    - 通货膨胀率在受到失业率冲击后，反应较为温和，且回归速度较快。\n    - 这表明失业率的变化对通货膨胀率的长期影响较小，但可能会在短期内引发一定的波动。\n\n### 总结\n通过脉冲响应分析可以看出，失业率和通货膨胀率之间存在一定的动态关系，但这种关系在短期内更为显著，长期影响则趋于平稳。这为进一步的经济建模和政策分析提供了重要的参考依据。\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":true,"highlight-style":"atom-one","css":["../styles.css"],"output-file":"TS_FRED_US_unemploy_rate.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.39","editor":"visual","theme":"cosmo","linestretch":1.6,"fontsize":"11.5pt","highlight":true,"callout-appearance":"default","md-extensions":["callout"],"includes":{"after-body":"../_includes/counter.html"},"title":"案例：美国失业率和通胀率关系分析"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}