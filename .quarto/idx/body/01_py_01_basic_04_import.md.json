{"title":"Python：import 使用详解","markdown":{"headingText":"Python：import 使用详解","containsRefs":false,"markdown":"\n## 引言\n\n对于 Python 初学者来说，经常会在代码的前几行看到如下语句：\n\n```python\nimport numpy as np\nimport yfinance as yf\nimport pandas as pd\nimport matplotlib.pyplot as plt\n```\n\n这时候，初学者往往会产生疑问：这些语句的作用是什么？为什么有时会看到很多类似的 `import` 语句？我如何知道自己需要导入哪些包？这些包到底是从哪里来的？它们如何帮助我实现特定的功能？\n\n在本篇讲义中，我们将深入探讨 `import` 语句的使用，特别是如何通过导入模块和包，来扩展 Python 的功能，避免重复编写代码，提高开发效率。\n\n通过实践，初学者可以逐渐掌握如何根据自己的需求，导入所需的库和模块，从而让自己的代码变得更加简洁且高效。\n\n## 什么是模块、包和函数？\n\n**函数 (Function)**\n\n在 Python 中，函数是程序的基本组成部分。函数是一段执行特定任务的代码，可以接收输入并返回输出。函数是我们编写高效、简洁代码的重要工具。\n\n例如，`math.sqrt()` 是 Python 标准库中的一个函数，用于计算平方根。它是一个模块中的一个功能。\n\n**模块 (Module)**\n\n模块是一个包含 Python 代码的文件，通常是一个 `.py` 文件。一个模块可以包含多个函数、类和变量，用来实现特定的功能。模块是对功能的封装，可以提高代码的可维护性和可复用性。\n\n例如，`math` 是一个标准库模块，它包含了许多数学计算相关的函数，如 `sqrt()`、`sin()`、`cos()` 等。\n\n**包 (Package)**\n\n包是一个包含多个模块的目录。包可以将相关的模块组织在一起，方便管理和使用。每个包目录中都会包含一个特殊的 `__init__.py` 文件，它标识该目录是一个包。\n\n例如，`numpy` 是一个非常常见的 Python 包，它包含多个子模块（如 `numpy.linalg` 用于线性代数运算，`numpy.fft` 用于傅里叶变换等）。\n\n**函数、模块和包之间的关系**\n\n为了更好地理解函数、模块和包之间的关系，下面是一个结构图：\n\n```\nPackage (包)\n    ├── Module (模块)\n    │     ├── Function (函数)\n    │     ├── Function (函数)\n    │     └── Class (类)\n    ├── Module (模块)\n    └── __init__.py\n```\n\n在上图中，我们可以看到：\n- **包（Package）** 是由多个 **模块（Module）** 组成的文件夹。\n- 每个 **模块（Module）** 内部可以包含多个 **函数（Function）**，也可以包含 **类（Class）**。\n- **函数** 是模块中的功能实现，它通常执行某一具体的任务。\n\n\n## import 语句：基本用法\n\n### 导入整个模块\n最常见的方式是导入整个模块：\n\n```python\nimport math\n```\n\n这样我们就可以使用 `math` 模块中的所有函数，如 `math.sqrt()`、`math.sin()` 等。\n\n### 给模块起别名\n为了提高代码的可读性和简洁性，我们通常给模块起一个别名，尤其是对于较长的模块名。例如，`numpy` 可以用 `np` 作为别名：\n\n```python\nimport numpy as np\n```\n\n之后，我们可以通过 `np` 来引用 `numpy` 中的函数或类：\n\n```python\narr = np.array([1, 2, 3])\nprint(arr)\n```\n\n### 从模块中导入特定函数\n如果只需要模块中的特定功能，可以直接导入所需的函数：\n\n```python\nfrom math import sqrt\n```\n\n此时，我们可以直接使用 `sqrt()` 函数，而不需要再写 `math.sqrt()`。\n\n\n## import 的机制\n\n### 导入的背后：存储和内存\n\n当你导入一个模块时，Python 会从其存储位置加载模块的代码到内存中，之后在内存中执行。对于标准库模块（如 `math`），它们已经随着 Python 安装包一起安装在你的电脑上，而第三方包（如 `numpy`、`yfinance` 等）需要通过 `pip` 或 `conda` 等工具安装，并通过 `import` 语句加载到内存中。\n\n### 为什么需要 import？\n\n很多初学者会问：“我已经安装了 `yfinance` 这个包，它已经在我的电脑上了，为什么每次使用时还要写 `import yfinance as yf`？”这是因为安装包并不会自动加载到 Python 的工作环境中。每次执行代码时，我们都需要明确告诉 Python 哪些功能是我们需要使用的，而 `import` 就是告诉 Python 去哪里找这些功能。`import` 将模块或包加载到内存中，以便在运行时使用。\n\n### 如何查看已安装包的存储位置？\n\n对于初学者来说，了解自己安装的包存储在哪里，有助于理解模块的导入机制。假设我们想查看 `numpy` 包的存储路径，可以使用以下 Python 命令：\n\n```python\nimport numpy\nprint(numpy.__file__)\n```\n\n这将输出 `numpy` 包的文件路径，类似于：\n\n```\nC:\\ProgramData\\anaconda3\\Lib\\site-packages\\numpy\n```\n\n在该路径下，你会看到 `numpy` 包的所有文件和子目录，包含了该包的源码、配置文件等。\n\n### 目录结构\n我们可以通过 `dir` 命令查看该路径下的所有文件。例如：\n\n```python\nimport os\nprint(os.listdir(r'C:\\ProgramData\\anaconda3\\Lib\\site-packages\\numpy'))\n```\n\n你还可以使用 `tree` 命令（如果安装了 `tree` 工具）以树形结构显示目录内容：\n\n```\nC:\\ProgramData\\anaconda3\\Lib\\site-packages\\numpy\n├── core\n│   ├── arrayobject.py       <- 用于数组操作的模块\n│   ├── umath.py             <- 数学运算模块\n│   └── ...\n├── linalg\n│   ├── linalg.py            <- 线性代数运算模块\n│   └── ...\n└── __init__.py              <- 初始化文件\n```\n\n### 从模块中导入特定函数的好处\n\n通过 `from module import function` 语句，我们可以只导入模块中的某个函数或类，而不是整个模块。这带来了几个好处：\n- **减少内存消耗**：只加载需要的部分，避免不必要的内存开销。\n- **简化代码**：导入函数后，我们可以直接使用函数名称，避免在代码中重复书写模块名。\n\n例如，从 `math` 模块中只导入 `sqrt` 函数：\n\n```python\nfrom math import sqrt\nprint(sqrt(25))  # 直接使用 sqrt 函数\n```\n\n## import 语句：高级用法\n\n### 动态导入\n在某些情况下，我们可能需要在运行时根据条件来导入模块，这时可以使用 `importlib`：\n\n```python\nimport importlib\n\nnumpy = importlib.import_module('numpy')\nprint(numpy.array([1, 2, 3]))\n```\n\n### 按需加载\n虽然通常情况下我们会在代码开始时导入所有需要的库，但在某些特殊情况下，按需加载可以提高代码的性能。例如：\n\n```python\ndef some_function():\n    import numpy as np\n    # 使用 numpy 库进行操作\n```\n\n这种方式可以避免在程序启动时加载不必要的库，但对于大多数用户来说，在文件开始部分就加载所有需要的包更直观。\n\n## 总结与建议\n\n在 Python 中，`import` 语句是非常重要的，它帮助我们将模块化的代码引入到程序中，提升代码的可重用性和模块化程度。我们可以通过导入整个模块、给模块起别名、从模块中导入特定功能等方式灵活地使用模块。\n\n在使用 `import` 时，我们需要根据实际需求选择合适的导入方式，避免命名冲突，并理解 `import` 是如何将模块加载到内存中的。继续实践并探索更多 Python 内置和第三方模块的使用，将会帮助你写出更简洁、可维护的代码。\n\n## 参考资料\n\n以下是与本讲义直接相关的一些链接，供读者扩展阅读：\n\n1. [Python 官方文档 - 模块](https://docs.python.org/3/tutorial/modules.html)\n2. [numpy 官方文档](https://numpy.org/doc/stable/)\n3. [Python 中的包和模块概念](https://realpython.com/python-modules-packages/)\n\n\n## 附录：提示词\n\n::: {.callout-tip}\n## 提示词\n\n### Prompt 1\n\n- 写一篇讲义，主题：Python 中的 import 使用详解。\n- 读者：初学者，对 Python 几乎一无所知\n- 语言风格：朴实，严谨。一个从事多年 Python 教学的教授所写\n\n你先帮我介绍一个提纲和思路，我修改确认后再开始写\n\n### Prompt 2\n\n补充：\n\n1. 为了让初学者有个直观的感受，能否以 numpy 包为例，介绍其存储位置，以及文件夹中的内>容。我的路径为「C:\\ProgramData\\anaconda3\\Lib\\site-packages\\numpy」，你可以在讲义中>介绍一些 Python 命令，以便读者能够获取它的电脑中的路径。总之，要提供一些指引，让读者能>够看到这个文件夹下的内容。也可以用 dir tree 结构图来呈现。似乎可以用 `sys.path` 命>令。\n2. 「引言」部分，可以采用更有趣的导入方式，比如：对于 Python 初学者而言，经常看到代码>的前几行会出现如下语句：\n\n```python\nimport numpy as np\nimport yfinance as yf\n……\n```\n\n不免产生如下疑问：这些语句的作用是什么？我如何知道我该 import 哪些 packages？……\n\n1. 「2. 什么是模块和包？」部分：可以先介绍一下 function 的概念，这是 Python 的基本元>素，然后再介绍更高阶的内容，这样读者更容易理解诸如 np.arry,  os.getcwd () 这样的表达>式\n2. 有一个重要的问题是：很多人认为，我已经 install 了 yfinance package，它已经存储在了>我的电脑上；另外， 诸如 math 这样的标准库模块，在我安装 Python 后 Anocanda 的时候就自>动安装在我的电脑中了，为何我用的时候还需要 import yfinance？你要在讲义的合适位置讲一下>这个问题。可能需要讲一下，import numpy 把【什么文件】导入到了【什么位置】（内存？），>这种做法的好处是什么？\n3. 「4.3 从模块中导入特定函数」部分，这种做法的好处是什么？\n4. 「6.2 按需加载」最好补充一个例子。不过，我猜测对于多数用户而言，这个问题并不重要。反>而是在文件开头部分就载入所有 packages 可以让代码更直观？\n  \n### Prompt 3\n\n修改：\n在「2. 什么是模块、包和函数？」部分，能否增加一个 结构图，更直观地展示 函数，模块和 package 之间的关系\n  \n### Prompt 4\n\n很好，整合成一个完整的文档。\n在结尾处提供 2-3 个与本讲义直接相关的链接，以便读者扩展阅读\n:::","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"wrap","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":true,"highlight-style":"atom-one","css":["../styles.css"],"output-file":"01_py_01_basic_04_import.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.39","editor":"visual","theme":"cosmo","linestretch":1.6,"fontsize":"11.5pt","highlight":true,"callout-appearance":"default","md-extensions":["callout"],"includes":{"after-body":"../_includes/counter.html"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}