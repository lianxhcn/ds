<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>35&nbsp; G8-中国上市公司 – 数据分析</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../homework/pre/Stock_G4_01_data_crawler.html" rel="next">
<link href="../../homework/pre/Dangdang_G7_02_data_analysis.html" rel="prev">
<link href="../../images/ds-book-logo-40.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e8fb9d25728d58bfeac61b497e4a6629.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8434d2026ae8291579158df2ad8dfa64.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../homework/pre/Dangdang_G7_01_data_clean.html"><strong>作业展示</strong></a></li><li class="breadcrumb-item"><a href="../../homework/pre/G8_China_stock_analysis.html"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">G8-中国上市公司</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="https://book.lianxh.cn/ds/index.html" class="sidebar-logo-link">
      <img src="../../images/ds-book-logo-40.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../"></a><a href="../../index.html">DS</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://www.lianxh.cn" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-house-fill"></i></a>
    <a href="https://lianxh-class.cn/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-camera-video-fill"></i></a>
    <a href="https://github.com/arlionn/ds" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">数据分析</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/_home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">关于我们</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/00_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">前言</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Python 基础</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/00_py_with_AI_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">借助 AI 写代码</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/00_py_with_AI_pic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ansome Python + AI</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_1_install-Python-Anocanda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Python：安装和环境配置</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_2_install_FAQs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Python 安装常见问题</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_3_markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_01_basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Python 入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_01_basic_01_grammer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Python 代码风格</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_01_basic_02_QuickReference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Python 常用命令速查表</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_01_basic_03_Packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Python 常用扩展包</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_01_basic_04_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Python：import 使用详解</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_01_basic_05_OOP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Python：语法解析-面向对象编程</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_01_basic_06_filepath.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Python 路径设置</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_02_numpy_scipy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_02_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">pandas 快速入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_03_matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Matplotlib简介</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_04_func_and_module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">函数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/01_py_05_class.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">类和对象</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>数据分析</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/data_02_data_type.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">数据分析是什么？</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/data_02_get_data_GMD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">获取数据：GMD</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/TS_SZ_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">上证指数的时序特征</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>可视化</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/graph_01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Python 可视化：简介</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/graph_dis_box_violin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">箱型图和小提琴图</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/graph_dis_histogram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">直方图</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/graph_dis_kdensity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">核密度函数图</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>回归分析</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/test_AB_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">A/B test-分组对照试验</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/regress_01_OLS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">线性回归模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/regress_02_wage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">线性回归分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/regress_03_binscatter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">分仓散点图</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>时间序列分析</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../body/TS_FRED_US_unemploy_rate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">案例：美国失业率和通胀率关系分析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>作业展示</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/Dangdang_G7_01_data_clean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">当当网-G7-01</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/Dangdang_G7_02_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">当当网-G7-02</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/G8_China_stock_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">G8-中国上市公司</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/Stock_G4_01_data_crawler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">G4-01</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/Stock_G4_02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">G4-02</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/Stock_G4_03_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">G4-03</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/_ex02_万诗晴.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">ex02_万诗晴</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/_ex02_吴倩茵.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">ex02_吴倩茵</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/_ex02_朱少荣.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">ex02_朱少荣</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../homework/pre/_ex02_黄伊姿.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">ex02_黄伊姿</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#数据分析与经济决策第一次小组作业" id="toc-数据分析与经济决策第一次小组作业" class="nav-link active" data-scroll-target="#数据分析与经济决策第一次小组作业"><span class="header-section-number">35.1</span> 《数据分析与经济决策》第一次小组作业</a></li>
  <li><a href="#t3中国上市公司数量年度统计" id="toc-t3中国上市公司数量年度统计" class="nav-link" data-scroll-target="#t3中国上市公司数量年度统计"><span class="header-section-number">35.2</span> T3：中国上市公司数量年度统计</a></li>
  <li><a href="#t3-1.1下载深交所数据" id="toc-t3-1.1下载深交所数据" class="nav-link" data-scroll-target="#t3-1.1下载深交所数据"><span class="header-section-number">35.3</span> T3-1.1：下载深交所数据</a></li>
  <li><a href="#t3-1.2下载上交所数据" id="toc-t3-1.2下载上交所数据" class="nav-link" data-scroll-target="#t3-1.2下载上交所数据"><span class="header-section-number">35.4</span> T3-1.2：下载上交所数据</a></li>
  <li><a href="#t3-1.3下载北交所数据" id="toc-t3-1.3下载北交所数据" class="nav-link" data-scroll-target="#t3-1.3下载北交所数据"><span class="header-section-number">35.5</span> T3-1.3：下载北交所数据</a></li>
  <li><a href="#t3-2.1上市公司数量统计和可视化" id="toc-t3-2.1上市公司数量统计和可视化" class="nav-link" data-scroll-target="#t3-2.1上市公司数量统计和可视化"><span class="header-section-number">35.6</span> T3-2.1：上市公司数量统计和可视化</a></li>
  <li><a href="#t3-2.2上市公司行业统计和可视化" id="toc-t3-2.2上市公司行业统计和可视化" class="nav-link" data-scroll-target="#t3-2.2上市公司行业统计和可视化"><span class="header-section-number">35.7</span> T3-2.2：上市公司行业统计和可视化</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../homework/pre/Dangdang_G7_01_data_clean.html"><strong>作业展示</strong></a></li><li class="breadcrumb-item"><a href="../../homework/pre/G8_China_stock_analysis.html"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">G8-中国上市公司</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">G8-中国上市公司</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="数据分析与经济决策第一次小组作业" class="level2" data-number="35.1">
<h2 data-number="35.1" class="anchored" data-anchor-id="数据分析与经济决策第一次小组作业"><span class="header-section-number">35.1</span> 《数据分析与经济决策》第一次小组作业</h2>
<p>8组：<br>
谢有春：24210175<br>
郭恩瑜：24210125<br>
赵晓燕：24210190<br>
李烨豪：24210142<br>
廖礼杨：24210145<br>
傅烨豪：24210123<br>
谭敏彬：24210160<br>
罗锐：24210154<br>
魏晓锐：24210167</p>
</section>
<section id="t3中国上市公司数量年度统计" class="level2" data-number="35.2">
<h2 data-number="35.2" class="anchored" data-anchor-id="t3中国上市公司数量年度统计"><span class="header-section-number">35.2</span> T3：中国上市公司数量年度统计</h2>
<p>作业描述：<br>
编写一个 Python 脚本，自动下载中国股票市场的概览数据，并进行简单的统计分析和可视化。</p>
<div id="5f890682-32c7-4f34-b2a0-2339dff60c4e" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> requests</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> json,time,os,re</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> random</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="t3-1.1下载深交所数据" class="level2" data-number="35.3">
<h2 data-number="35.3" class="anchored" data-anchor-id="t3-1.1下载深交所数据"><span class="header-section-number">35.3</span> T3-1.1：下载深交所数据</h2>
<p>数据来源：https://www.szse.cn/market/stock/indicator/index.html</p>
<div id="ded7cd1d-b50a-409b-9257-e5ba95ad70e8" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> getSZ(idx,tabName):</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2008</span>,<span class="dv">2026</span>):</span>
<span id="cb2-3"><a href="#cb2-3"></a>        <span class="cf">if</span> (year <span class="op">&gt;</span> <span class="dv">2021</span> <span class="kw">and</span> tabName <span class="op">==</span> <span class="st">'中小板'</span>) <span class="kw">or</span> (tabName <span class="op">==</span> <span class="st">'主板'</span> <span class="kw">and</span> year<span class="op">==</span><span class="dv">2008</span>) <span class="kw">or</span> (tabName <span class="op">==</span> <span class="st">'创业板'</span> <span class="kw">and</span> year <span class="kw">in</span> [<span class="dv">2008</span>,<span class="dv">2009</span>]):</span>
<span id="cb2-4"><a href="#cb2-4"></a>            <span class="cf">continue</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="ss">f'./上市公司总数/深圳_</span><span class="sc">{</span>tabName<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json'</span>):</span>
<span id="cb2-6"><a href="#cb2-6"></a>            url <span class="op">=</span> <span class="ss">f"https://www.szse.cn/api/report/ShowReport/data?SHOWTYPE=JSON&amp;CATALOGID=1803_after&amp;TABKEY=tab</span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">&amp;txtQueryDate=</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">-04-26&amp;random=</span><span class="sc">{</span>random<span class="sc">.</span>random()<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>            headers <span class="op">=</span> {</span>
<span id="cb2-8"><a href="#cb2-8"></a>            <span class="st">"Accept"</span>: <span class="st">"application/json, text/javascript, */*; q=0.01"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>            <span class="st">"Accept-Encoding"</span>: <span class="st">"gzip, deflate, br, zstd"</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>            <span class="st">"Accept-Language"</span>: <span class="st">"zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7"</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>            <span class="st">"Cache-Control"</span>: <span class="st">"no-cache"</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>            <span class="st">"Content-Type"</span>: <span class="st">"application/json"</span>,</span>
<span id="cb2-13"><a href="#cb2-13"></a>            <span class="st">"Host"</span>: <span class="st">"www.szse.cn"</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>            <span class="st">"Pragma"</span>: <span class="st">"no-cache"</span>,</span>
<span id="cb2-15"><a href="#cb2-15"></a>            <span class="st">"Referer"</span>: <span class="st">"https://www.szse.cn/market/stock/indicator/index.html"</span>,</span>
<span id="cb2-16"><a href="#cb2-16"></a>            <span class="st">"Sec-Fetch-Dest"</span>: <span class="st">"empty"</span>,</span>
<span id="cb2-17"><a href="#cb2-17"></a>            <span class="st">"Sec-Fetch-Mode"</span>: <span class="st">"cors"</span>,</span>
<span id="cb2-18"><a href="#cb2-18"></a>            <span class="st">"Sec-Fetch-Site"</span>: <span class="st">"same-origin"</span>,</span>
<span id="cb2-19"><a href="#cb2-19"></a>            <span class="st">"User-Agent"</span>: <span class="st">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"</span>,</span>
<span id="cb2-20"><a href="#cb2-20"></a>            <span class="st">"X-Request-Type"</span>: <span class="st">"ajax"</span>,</span>
<span id="cb2-21"><a href="#cb2-21"></a>            <span class="st">"X-Requested-With"</span>: <span class="st">"XMLHttpRequest"</span>,</span>
<span id="cb2-22"><a href="#cb2-22"></a>            <span class="st">"sec-ch-ua"</span>: <span class="st">"</span><span class="ch">\"</span><span class="st">Chromium</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">136</span><span class="ch">\"</span><span class="st">, </span><span class="ch">\"</span><span class="st">Google Chrome</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">136</span><span class="ch">\"</span><span class="st">, </span><span class="ch">\"</span><span class="st">Not.A/Brand</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">99</span><span class="ch">\"</span><span class="st">"</span>,</span>
<span id="cb2-23"><a href="#cb2-23"></a>            <span class="st">"sec-ch-ua-mobile"</span>: <span class="st">"?0"</span>,</span>
<span id="cb2-24"><a href="#cb2-24"></a>            <span class="st">"sec-ch-ua-platform"</span>: <span class="st">"Windows"</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>            }</span>
<span id="cb2-26"><a href="#cb2-26"></a>            response <span class="op">=</span> requests.get(url,headers<span class="op">=</span>headers).json()</span>
<span id="cb2-27"><a href="#cb2-27"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f'./上市公司总数/深圳_</span><span class="sc">{</span>tabName<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json'</span>,<span class="st">'w'</span>,encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb2-28"><a href="#cb2-28"></a>                json.dump(response,f,indent<span class="op">=</span><span class="dv">4</span>,ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-29"><a href="#cb2-29"></a>            <span class="bu">print</span>(<span class="ss">f'./上市公司总数/深圳_</span><span class="sc">{</span>tabName<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json done..'</span>)</span>
<span id="cb2-30"><a href="#cb2-30"></a>        <span class="cf">else</span>:</span>
<span id="cb2-31"><a href="#cb2-31"></a>            <span class="bu">print</span>(<span class="ss">f'./上市公司总数/深圳_</span><span class="sc">{</span>tabName<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json existed..'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a8714a07-f387-4bc1-9a9d-04814f4b3dad" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>getSZ(<span class="dv">2</span>,<span class="st">"主板"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>getSZ(<span class="dv">3</span>,<span class="st">'中小板'</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>getSZ(<span class="dv">4</span>,<span class="st">"创业板"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>./上市公司总数/深圳_主板_2009.json existed..
./上市公司总数/深圳_主板_2010.json existed..
./上市公司总数/深圳_主板_2011.json existed..
./上市公司总数/深圳_主板_2012.json existed..
./上市公司总数/深圳_主板_2013.json existed..
./上市公司总数/深圳_主板_2014.json existed..
./上市公司总数/深圳_主板_2015.json existed..
./上市公司总数/深圳_主板_2016.json existed..
./上市公司总数/深圳_主板_2017.json existed..
./上市公司总数/深圳_主板_2018.json existed..
./上市公司总数/深圳_主板_2019.json existed..
./上市公司总数/深圳_主板_2020.json existed..
./上市公司总数/深圳_主板_2021.json existed..
./上市公司总数/深圳_主板_2022.json existed..
./上市公司总数/深圳_主板_2023.json existed..
./上市公司总数/深圳_主板_2024.json existed..
./上市公司总数/深圳_主板_2025.json existed..
./上市公司总数/深圳_中小板_2008.json existed..
./上市公司总数/深圳_中小板_2009.json existed..
./上市公司总数/深圳_中小板_2010.json existed..
./上市公司总数/深圳_中小板_2011.json existed..
./上市公司总数/深圳_中小板_2012.json existed..
./上市公司总数/深圳_中小板_2013.json existed..
./上市公司总数/深圳_中小板_2014.json existed..
./上市公司总数/深圳_中小板_2015.json existed..
./上市公司总数/深圳_中小板_2016.json existed..
./上市公司总数/深圳_中小板_2017.json existed..
./上市公司总数/深圳_中小板_2018.json existed..
./上市公司总数/深圳_中小板_2019.json existed..
./上市公司总数/深圳_中小板_2020.json existed..
./上市公司总数/深圳_中小板_2021.json existed..
./上市公司总数/深圳_创业板_2010.json existed..
./上市公司总数/深圳_创业板_2011.json existed..
./上市公司总数/深圳_创业板_2012.json existed..
./上市公司总数/深圳_创业板_2013.json existed..
./上市公司总数/深圳_创业板_2014.json existed..
./上市公司总数/深圳_创业板_2015.json existed..
./上市公司总数/深圳_创业板_2016.json existed..
./上市公司总数/深圳_创业板_2017.json existed..
./上市公司总数/深圳_创业板_2018.json existed..
./上市公司总数/深圳_创业板_2019.json existed..
./上市公司总数/深圳_创业板_2020.json existed..
./上市公司总数/深圳_创业板_2021.json existed..
./上市公司总数/深圳_创业板_2022.json existed..
./上市公司总数/深圳_创业板_2023.json existed..
./上市公司总数/深圳_创业板_2024.json existed..
./上市公司总数/深圳_创业板_2025.json existed..</code></pre>
</div>
</div>
</section>
<section id="t3-1.2下载上交所数据" class="level2" data-number="35.4">
<h2 data-number="35.4" class="anchored" data-anchor-id="t3-1.2下载上交所数据"><span class="header-section-number">35.4</span> T3-1.2：下载上交所数据</h2>
<p>数据来源：https://www.sse.com.cn/market/view/</p>
<div id="2c225fc7-2f23-4646-8d4b-8336dcd95f76" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">def</span> getSH():</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1999</span>,<span class="dv">2026</span>):</span>
<span id="cb5-3"><a href="#cb5-3"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="ss">f'./上市公司总数/上海_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json'</span>):</span>
<span id="cb5-4"><a href="#cb5-4"></a>            url <span class="op">=</span> <span class="ss">f"https://query.sse.com.cn/commonQuery.do?jsonCallBack=jsonpCallback9178123</span><span class="sc">{</span>random<span class="sc">.</span>randint(<span class="dv">1</span>,<span class="dv">9</span>)<span class="sc">}</span><span class="ss">&amp;isPagination=false&amp;sqlId=COMMON_SSE_SJ_SCGM_C&amp;TRADE_DATE=</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">-04-01&amp;_=</span><span class="sc">{</span><span class="bu">int</span>(time.time()<span class="op">*</span><span class="dv">1000</span>)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>            headers <span class="op">=</span> {</span>
<span id="cb5-6"><a href="#cb5-6"></a>                <span class="st">"accept"</span>: <span class="st">"*/*"</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>                <span class="st">"accept-encoding"</span>: <span class="st">"gzip, deflate, br, zstd"</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a>                <span class="st">"accept-language"</span>: <span class="st">"zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7"</span>,</span>
<span id="cb5-9"><a href="#cb5-9"></a>                <span class="st">"cache-control"</span>: <span class="st">"no-cache"</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a>                <span class="st">"connection"</span>: <span class="st">"keep-alive"</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a>                <span class="st">"cookie"</span>: <span class="st">"gdp_user_id=gioenc-7ad16db8%2Cab74%2C567c%2C894g%2C49dg262gc899; ba17301551dcbaf9_gdp_session_id=7afc67b1-5607-46e3-b50c-d467c7a2f80b; ba17301551dcbaf9_gdp_session_id_sent=7afc67b1-5607-46e3-b50c-d467c7a2f80b; ba17301551dcbaf9_gdp_sequence_ids={</span><span class="sc">%22g</span><span class="st">lobalKey%22:80%2C%22VISIT%22:3%2C%22PAGE%22:11%2C%22VIEW_CLICK%22:68}"</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>                <span class="st">"host"</span>: <span class="st">"query.sse.com.cn"</span>,</span>
<span id="cb5-13"><a href="#cb5-13"></a>                <span class="st">"pragma"</span>: <span class="st">"no-cache"</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>                <span class="st">"referer"</span>: <span class="st">"https://www.sse.com.cn/"</span>,</span>
<span id="cb5-15"><a href="#cb5-15"></a>                <span class="st">"sec-ch-ua"</span>: <span class="st">"</span><span class="ch">\"</span><span class="st">Chromium</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">136</span><span class="ch">\"</span><span class="st">, </span><span class="ch">\"</span><span class="st">Google Chrome</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">136</span><span class="ch">\"</span><span class="st">, </span><span class="ch">\"</span><span class="st">Not.A/Brand</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">99</span><span class="ch">\"</span><span class="st">"</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>                <span class="st">"sec-ch-ua-mobile"</span>: <span class="st">"?0"</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>                <span class="st">"sec-ch-ua-platform"</span>: <span class="st">"Windows"</span>,</span>
<span id="cb5-18"><a href="#cb5-18"></a>                <span class="st">"sec-fetch-dest"</span>: <span class="st">"script"</span>,</span>
<span id="cb5-19"><a href="#cb5-19"></a>                <span class="st">"sec-fetch-mode"</span>: <span class="st">"no-cors"</span>,</span>
<span id="cb5-20"><a href="#cb5-20"></a>                <span class="st">"sec-fetch-site"</span>: <span class="st">"same-site"</span>,</span>
<span id="cb5-21"><a href="#cb5-21"></a>                <span class="st">"user-agent"</span>: <span class="st">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>            }</span>
<span id="cb5-23"><a href="#cb5-23"></a>            response <span class="op">=</span> requests.get(url,headers<span class="op">=</span>headers).text</span>
<span id="cb5-24"><a href="#cb5-24"></a>            res <span class="op">=</span> json.loads(re.findall(<span class="st">"\((\{.*})\)"</span>,response)[<span class="dv">0</span>])</span>
<span id="cb5-25"><a href="#cb5-25"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f'./上市公司总数/上海_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json'</span>,<span class="st">'w'</span>,encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb5-26"><a href="#cb5-26"></a>                json.dump(res,f,indent<span class="op">=</span><span class="dv">4</span>,ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-27"><a href="#cb5-27"></a>            <span class="bu">print</span>(<span class="ss">f'./上市公司总数/上海_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json done..'</span>)</span>
<span id="cb5-28"><a href="#cb5-28"></a>        <span class="cf">else</span>:</span>
<span id="cb5-29"><a href="#cb5-29"></a>            <span class="bu">print</span>(<span class="ss">f'./上市公司总数/上海_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json existed..'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&lt;&gt;:24: SyntaxWarning: invalid escape sequence '\('
&lt;&gt;:24: SyntaxWarning: invalid escape sequence '\('
C:\Users\xiaor\AppData\Local\Temp\ipykernel_4016\1144392208.py:24: SyntaxWarning: invalid escape sequence '\('
  res = json.loads(re.findall("\((\{.*})\)",response)[0])</code></pre>
</div>
</div>
<div id="a486f220-194a-4b46-94c2-75741c83ba04" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>getSH()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>./上市公司总数/上海_1999.json existed..
./上市公司总数/上海_2000.json existed..
./上市公司总数/上海_2001.json existed..
./上市公司总数/上海_2002.json existed..
./上市公司总数/上海_2003.json existed..
./上市公司总数/上海_2004.json existed..
./上市公司总数/上海_2005.json existed..
./上市公司总数/上海_2006.json existed..
./上市公司总数/上海_2007.json existed..
./上市公司总数/上海_2008.json existed..
./上市公司总数/上海_2009.json existed..
./上市公司总数/上海_2010.json existed..
./上市公司总数/上海_2011.json existed..
./上市公司总数/上海_2012.json existed..
./上市公司总数/上海_2013.json existed..
./上市公司总数/上海_2014.json existed..
./上市公司总数/上海_2015.json existed..
./上市公司总数/上海_2016.json existed..
./上市公司总数/上海_2017.json existed..
./上市公司总数/上海_2018.json existed..
./上市公司总数/上海_2019.json existed..
./上市公司总数/上海_2020.json existed..
./上市公司总数/上海_2021.json existed..
./上市公司总数/上海_2022.json existed..
./上市公司总数/上海_2023.json existed..
./上市公司总数/上海_2024.json existed..
./上市公司总数/上海_2025.json existed..</code></pre>
</div>
</div>
</section>
<section id="t3-1.3下载北交所数据" class="level2" data-number="35.5">
<h2 data-number="35.5" class="anchored" data-anchor-id="t3-1.3下载北交所数据"><span class="header-section-number">35.5</span> T3-1.3：下载北交所数据</h2>
<p>数据来源：https://www.bse.cn/static/statisticdata.html</p>
<div id="76c4ce5c-1759-4dbc-99cd-6b8785cdfe98" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> getBJ():</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2022</span>,<span class="dv">2026</span>):</span>
<span id="cb9-3"><a href="#cb9-3"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="ss">f'./上市公司总数/北交所_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json'</span>):</span>
<span id="cb9-4"><a href="#cb9-4"></a>            url <span class="op">=</span> <span class="st">"https://www.bse.cn/marketStatController/dailyReport.do?callback=jQuery331_1748198810903"</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>            headers <span class="op">=</span> {</span>
<span id="cb9-6"><a href="#cb9-6"></a>                <span class="st">"Accept"</span>: <span class="st">"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"</span>,</span>
<span id="cb9-7"><a href="#cb9-7"></a>                <span class="st">"Accept-Encoding"</span>: <span class="st">"gzip, deflate, br, zstd"</span>,</span>
<span id="cb9-8"><a href="#cb9-8"></a>                <span class="st">"Accept-Language"</span>: <span class="st">"zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7"</span>,</span>
<span id="cb9-9"><a href="#cb9-9"></a>                <span class="st">"Cache-Control"</span>: <span class="st">"no-cache"</span>,</span>
<span id="cb9-10"><a href="#cb9-10"></a>                <span class="st">"Connection"</span>: <span class="st">"keep-alive"</span>,</span>
<span id="cb9-11"><a href="#cb9-11"></a>                <span class="st">"Content-Length"</span>: <span class="st">"15"</span>,</span>
<span id="cb9-12"><a href="#cb9-12"></a>                <span class="st">"Content-Type"</span>: <span class="st">"application/x-www-form-urlencoded; charset=UTF-8"</span>,</span>
<span id="cb9-13"><a href="#cb9-13"></a>                <span class="st">"Cookie"</span>: <span class="st">"Hm_lvt_ef6193a308904a92936b38108b93bd7f=1748198764; HMACCOUNT=22BC53625476F081; Hm_lpvt_ef6193a308904a92936b38108b93bd7f=1748198811; C3VK=ae7d82"</span>,</span>
<span id="cb9-14"><a href="#cb9-14"></a>                <span class="st">"Host"</span>: <span class="st">"www.bse.cn"</span>,</span>
<span id="cb9-15"><a href="#cb9-15"></a>                <span class="st">"Origin"</span>: <span class="st">"https://www.bse.cn"</span>,</span>
<span id="cb9-16"><a href="#cb9-16"></a>                <span class="st">"Pragma"</span>: <span class="st">"no-cache"</span>,</span>
<span id="cb9-17"><a href="#cb9-17"></a>                <span class="st">"Referer"</span>: <span class="st">"https://www.bse.cn/static/statisticdata.html"</span>,</span>
<span id="cb9-18"><a href="#cb9-18"></a>                <span class="st">"Sec-Fetch-Dest"</span>: <span class="st">"empty"</span>,</span>
<span id="cb9-19"><a href="#cb9-19"></a>                <span class="st">"Sec-Fetch-Mode"</span>: <span class="st">"cors"</span>,</span>
<span id="cb9-20"><a href="#cb9-20"></a>                <span class="st">"Sec-Fetch-Site"</span>: <span class="st">"same-origin"</span>,</span>
<span id="cb9-21"><a href="#cb9-21"></a>                <span class="st">"User-Agent"</span>: <span class="st">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"</span>,</span>
<span id="cb9-22"><a href="#cb9-22"></a>                <span class="st">"X-Requested-With"</span>: <span class="st">"XMLHttpRequest"</span>,</span>
<span id="cb9-23"><a href="#cb9-23"></a>                <span class="st">"sec-ch-ua"</span>: <span class="st">"</span><span class="ch">\"</span><span class="st">Chromium</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">136</span><span class="ch">\"</span><span class="st">, </span><span class="ch">\"</span><span class="st">Google Chrome</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">136</span><span class="ch">\"</span><span class="st">, </span><span class="ch">\"</span><span class="st">Not.A/Brand</span><span class="ch">\"</span><span class="st">;v=</span><span class="ch">\"</span><span class="st">99</span><span class="ch">\"</span><span class="st">"</span>,</span>
<span id="cb9-24"><a href="#cb9-24"></a>                <span class="st">"sec-ch-ua-mobile"</span>: <span class="st">"?0"</span>,</span>
<span id="cb9-25"><a href="#cb9-25"></a>                <span class="st">"sec-ch-ua-platform"</span>: <span class="st">"Windows"</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>            }</span>
<span id="cb9-27"><a href="#cb9-27"></a>            payload <span class="op">=</span> {</span>
<span id="cb9-28"><a href="#cb9-28"></a>                <span class="st">'HQJSRQ'</span>: <span class="ss">f"</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">0523"</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>            }</span>
<span id="cb9-30"><a href="#cb9-30"></a>            response <span class="op">=</span> requests.post(url,headers<span class="op">=</span>headers,data<span class="op">=</span>payload).text</span>
<span id="cb9-31"><a href="#cb9-31"></a>            res <span class="op">=</span> json.loads(re.findall(<span class="st">'\((.*)\)'</span>,response)[<span class="dv">0</span>])</span>
<span id="cb9-32"><a href="#cb9-32"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f'./上市公司总数/北交所_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json'</span>,<span class="st">'w'</span>,encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb9-33"><a href="#cb9-33"></a>                json.dump(res,f,indent<span class="op">=</span><span class="dv">4</span>,ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-34"><a href="#cb9-34"></a>            <span class="bu">print</span>(<span class="ss">f'./上市公司总数/北交所_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json done..'</span>)</span>
<span id="cb9-35"><a href="#cb9-35"></a>        <span class="cf">else</span>:</span>
<span id="cb9-36"><a href="#cb9-36"></a>            <span class="bu">print</span>(<span class="ss">f'./上市公司总数/北交所_</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">.json existed..'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&lt;&gt;:31: SyntaxWarning: invalid escape sequence '\('
&lt;&gt;:31: SyntaxWarning: invalid escape sequence '\('
C:\Users\xiaor\AppData\Local\Temp\ipykernel_4016\1700096796.py:31: SyntaxWarning: invalid escape sequence '\('
  res = json.loads(re.findall('\((.*)\)',response)[0])</code></pre>
</div>
</div>
<div id="b8aa86f5-606e-4a3d-b67b-ea641e1d191e" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>getBJ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>./上市公司总数/北交所_2022.json existed..
./上市公司总数/北交所_2023.json existed..
./上市公司总数/北交所_2024.json existed..
./上市公司总数/北交所_2025.json existed..</code></pre>
</div>
</div>
</section>
<section id="t3-2.1上市公司数量统计和可视化" class="level2" data-number="35.6">
<h2 data-number="35.6" class="anchored" data-anchor-id="t3-2.1上市公司数量统计和可视化"><span class="header-section-number">35.6</span> T3-2.1：上市公司数量统计和可视化</h2>
<div id="ae10f0f7-834a-4f58-8569-8fb1ccb8b96f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>datalist <span class="op">=</span> []</span>
<span id="cb13-2"><a href="#cb13-2"></a>files <span class="op">=</span> os.listdir(<span class="st">'上市公司总数'</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="cf">if</span> <span class="bu">file</span>.startswith(<span class="st">'.'</span>):</span>
<span id="cb13-5"><a href="#cb13-5"></a>        <span class="cf">continue</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f'./上市公司总数/</span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss">'</span>,<span class="st">'r'</span>,encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb13-7"><a href="#cb13-7"></a>        obj <span class="op">=</span> json.load(f)</span>
<span id="cb13-8"><a href="#cb13-8"></a>    year <span class="op">=</span> <span class="bu">file</span>.split(<span class="st">'_'</span>)[<span class="op">-</span><span class="dv">1</span>].split(<span class="st">'.'</span>)[<span class="dv">0</span>]</span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="cf">if</span> <span class="bu">file</span>.startswith(<span class="st">'深圳'</span>):</span>
<span id="cb13-10"><a href="#cb13-10"></a>        tabName <span class="op">=</span> <span class="bu">file</span>.split(<span class="st">'_'</span>)[<span class="dv">1</span>]</span>
<span id="cb13-11"><a href="#cb13-11"></a>        <span class="cf">if</span> tabName <span class="op">==</span> <span class="st">'主板'</span>:</span>
<span id="cb13-12"><a href="#cb13-12"></a>            num <span class="op">=</span> obj[<span class="dv">1</span>][<span class="st">"data"</span>][<span class="dv">1</span>][<span class="st">"today"</span>].replace(<span class="st">','</span>,<span class="st">''</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a>        <span class="cf">elif</span> tabName <span class="op">==</span> <span class="st">'中小板'</span>:</span>
<span id="cb13-14"><a href="#cb13-14"></a>            num <span class="op">=</span> obj[<span class="dv">2</span>][<span class="st">"data"</span>][<span class="dv">1</span>][<span class="st">"today"</span>].replace(<span class="st">','</span>,<span class="st">''</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a>        <span class="cf">else</span>:</span>
<span id="cb13-16"><a href="#cb13-16"></a>            <span class="bu">print</span>(<span class="bu">file</span>)</span>
<span id="cb13-17"><a href="#cb13-17"></a>            num <span class="op">=</span> obj[<span class="op">-</span><span class="dv">1</span>][<span class="st">"data"</span>][<span class="dv">1</span>][<span class="st">"today"</span>].replace(<span class="st">','</span>,<span class="st">''</span>)</span>
<span id="cb13-18"><a href="#cb13-18"></a>        year <span class="op">=</span> <span class="bu">file</span>.split(<span class="st">'_'</span>)[<span class="dv">2</span>].split(<span class="st">'.'</span>)[<span class="dv">0</span>]</span>
<span id="cb13-19"><a href="#cb13-19"></a>        datalist.append([<span class="st">'深圳'</span>,year,tabName,num])</span>
<span id="cb13-20"><a href="#cb13-20"></a>    <span class="cf">elif</span> <span class="bu">file</span>.startswith(<span class="st">'上海'</span>): </span>
<span id="cb13-21"><a href="#cb13-21"></a>        results <span class="op">=</span> obj[<span class="st">'result'</span>]</span>
<span id="cb13-22"><a href="#cb13-22"></a>        <span class="cf">for</span> result <span class="kw">in</span> results:</span>
<span id="cb13-23"><a href="#cb13-23"></a>            <span class="cf">if</span> result[<span class="st">'PRODUCT_NAME'</span>] <span class="kw">in</span> [<span class="st">'股票'</span>,<span class="st">'主板A'</span>,<span class="st">'主板B'</span>,<span class="st">"科创板"</span>]:</span>
<span id="cb13-24"><a href="#cb13-24"></a>                tabName <span class="op">=</span> result[<span class="st">'PRODUCT_NAME'</span>]</span>
<span id="cb13-25"><a href="#cb13-25"></a>                num <span class="op">=</span> result[<span class="st">'SECURITY_NUM'</span>]</span>
<span id="cb13-26"><a href="#cb13-26"></a>                datalist.append([<span class="st">'上海'</span>,year,tabName,num])</span>
<span id="cb13-27"><a href="#cb13-27"></a>    <span class="cf">elif</span> <span class="bu">file</span>.startswith(<span class="st">'北交所'</span>):</span>
<span id="cb13-28"><a href="#cb13-28"></a>        <span class="cf">for</span> item <span class="kw">in</span> obj:</span>
<span id="cb13-29"><a href="#cb13-29"></a>            <span class="cf">if</span> item[<span class="st">'xxzrlx'</span>] <span class="op">==</span> <span class="st">'B'</span>:</span>
<span id="cb13-30"><a href="#cb13-30"></a>                num <span class="op">=</span> item[<span class="st">'gpgsjs'</span>]</span>
<span id="cb13-31"><a href="#cb13-31"></a>                datalist.append([<span class="st">'北交所'</span>,year,<span class="st">"股票数据"</span>,num])</span>
<span id="cb13-32"><a href="#cb13-32"></a>df <span class="op">=</span> pd.DataFrame(datalist,columns<span class="op">=</span>[<span class="st">'exchange'</span>,<span class="st">'year'</span>,<span class="st">'tab'</span>,<span class="st">'num'</span>])</span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co"># 数据类型转化</span></span>
<span id="cb13-34"><a href="#cb13-34"></a>df[<span class="st">'num'</span>] <span class="op">=</span> df[<span class="st">'num'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : <span class="bu">int</span>(<span class="bu">float</span>(x)))</span>
<span id="cb13-35"><a href="#cb13-35"></a>df[<span class="st">'year'</span>] <span class="op">=</span> df[<span class="st">'year'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : <span class="bu">int</span>(x))</span>
<span id="cb13-36"><a href="#cb13-36"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>深圳_创业板_2010.json
深圳_创业板_2011.json
深圳_创业板_2012.json
深圳_创业板_2013.json
深圳_创业板_2014.json
深圳_创业板_2015.json
深圳_创业板_2016.json
深圳_创业板_2017.json
深圳_创业板_2018.json
深圳_创业板_2019.json
深圳_创业板_2020.json
深圳_创业板_2021.json
深圳_创业板_2022.json
深圳_创业板_2023.json
深圳_创业板_2024.json
深圳_创业板_2025.json</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">exchange</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">tab</th>
<th data-quarto-table-cell-role="th">num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>上海</td>
<td>2019</td>
<td>股票</td>
<td>1508</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>上海</td>
<td>2019</td>
<td>主板A</td>
<td>1457</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>上海</td>
<td>2019</td>
<td>主板B</td>
<td>51</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>上海</td>
<td>2020</td>
<td>股票</td>
<td>1648</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>上海</td>
<td>2020</td>
<td>主板A</td>
<td>1504</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>深圳</td>
<td>2021</td>
<td>创业板</td>
<td>925</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">70</td>
<td>深圳</td>
<td>2022</td>
<td>创业板</td>
<td>1126</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">71</td>
<td>深圳</td>
<td>2023</td>
<td>创业板</td>
<td>1255</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">72</td>
<td>深圳</td>
<td>2024</td>
<td>创业板</td>
<td>1341</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">73</td>
<td>深圳</td>
<td>2025</td>
<td>创业板</td>
<td>1377</td>
</tr>
</tbody>
</table>

<p>74 rows × 4 columns</p>
</div>
</div>
</div>
<div id="0de10bb7-351b-4ddb-bca2-60c6a0254875" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># 设置主题样式</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a>plt.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> [<span class="st">'SimHei'</span>]  <span class="co"># 设置中文字体</span></span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co"># 数据预处理</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># 去除"股票"类别（保留具体板块数据）</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>df_clean <span class="op">=</span> df[df[<span class="st">'tab'</span>] <span class="op">!=</span> <span class="st">'股票'</span>].copy()</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co"># 合并上海主板A/B</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>df_clean[<span class="st">'tab'</span>] <span class="op">=</span> df_clean[<span class="st">'tab'</span>].replace({<span class="st">'主板A'</span>: <span class="st">'主板'</span>, <span class="st">'主板B'</span>: <span class="st">'主板'</span>})</span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co"># 按交易所+年份+板块分组汇总</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>df_grouped <span class="op">=</span> df_clean.groupby([<span class="st">'exchange'</span>, <span class="st">'year'</span>, <span class="st">'tab'</span>])[<span class="st">'num'</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb15-18"><a href="#cb15-18"></a></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co"># 定义通用绘图函数</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="kw">def</span> plot_exchange(data, exchange_name):</span>
<span id="cb15-21"><a href="#cb15-21"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb15-22"><a href="#cb15-22"></a>    tabs <span class="op">=</span> data[<span class="st">'tab'</span>].unique()</span>
<span id="cb15-23"><a href="#cb15-23"></a>    </span>
<span id="cb15-24"><a href="#cb15-24"></a>    <span class="cf">for</span> tab <span class="kw">in</span> tabs:</span>
<span id="cb15-25"><a href="#cb15-25"></a>        subset <span class="op">=</span> data[data[<span class="st">'tab'</span>] <span class="op">==</span> tab].sort_values(<span class="st">'year'</span>)</span>
<span id="cb15-26"><a href="#cb15-26"></a>        plt.plot(subset[<span class="st">'year'</span>], subset[<span class="st">'num'</span>], </span>
<span id="cb15-27"><a href="#cb15-27"></a>                 marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span>tab)</span>
<span id="cb15-28"><a href="#cb15-28"></a>    </span>
<span id="cb15-29"><a href="#cb15-29"></a>    plt.title(<span class="ss">f'</span><span class="sc">{</span>exchange_name<span class="sc">}</span><span class="ss">上市公司数量年度趋势'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb15-30"><a href="#cb15-30"></a>    plt.xlabel(<span class="st">'年份'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb15-31"><a href="#cb15-31"></a>    plt.ylabel(<span class="st">'上市公司数量'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb15-32"><a href="#cb15-32"></a>    plt.xticks(data[<span class="st">'year'</span>].unique().astype(<span class="bu">int</span>))  <span class="co"># 确保年份显示为整数</span></span>
<span id="cb15-33"><a href="#cb15-33"></a>    plt.legend(title<span class="op">=</span><span class="st">'板块分类'</span>)</span>
<span id="cb15-34"><a href="#cb15-34"></a>    plt.tight_layout()</span>
<span id="cb15-35"><a href="#cb15-35"></a>    plt.show()</span>
<span id="cb15-36"><a href="#cb15-36"></a></span>
<span id="cb15-37"><a href="#cb15-37"></a><span class="co"># 深圳交易所可视化</span></span>
<span id="cb15-38"><a href="#cb15-38"></a>shenzhen <span class="op">=</span> df_grouped[df_grouped[<span class="st">'exchange'</span>] <span class="op">==</span> <span class="st">'深圳'</span>]</span>
<span id="cb15-39"><a href="#cb15-39"></a>plot_exchange(shenzhen, <span class="st">'深圳交易所'</span>)</span>
<span id="cb15-40"><a href="#cb15-40"></a></span>
<span id="cb15-41"><a href="#cb15-41"></a><span class="co"># 上海交易所可视化</span></span>
<span id="cb15-42"><a href="#cb15-42"></a>shanghai <span class="op">=</span> df_grouped[df_grouped[<span class="st">'exchange'</span>] <span class="op">==</span> <span class="st">'上海'</span>]</span>
<span id="cb15-43"><a href="#cb15-43"></a>plot_exchange(shanghai, <span class="st">'上海交易所'</span>)</span>
<span id="cb15-44"><a href="#cb15-44"></a></span>
<span id="cb15-45"><a href="#cb15-45"></a><span class="co"># 北交所可视化</span></span>
<span id="cb15-46"><a href="#cb15-46"></a>beijing <span class="op">=</span> df_grouped[df_grouped[<span class="st">'exchange'</span>] <span class="op">==</span> <span class="st">'北交所'</span>]</span>
<span id="cb15-47"><a href="#cb15-47"></a><span class="cf">if</span> <span class="kw">not</span> beijing.empty:</span>
<span id="cb15-48"><a href="#cb15-48"></a>    plot_exchange(beijing, <span class="st">'北交所'</span>)</span>
<span id="cb15-49"><a href="#cb15-49"></a><span class="cf">else</span>:</span>
<span id="cb15-50"><a href="#cb15-50"></a>    <span class="bu">print</span>(<span class="st">"注意：数据中未发现北交所相关记录，请检查exchange字段取值"</span>)</span>
<span id="cb15-51"><a href="#cb15-51"></a></span>
<span id="cb15-52"><a href="#cb15-52"></a><span class="co"># 绘制堆叠面积图展示板块构成</span></span>
<span id="cb15-53"><a href="#cb15-53"></a><span class="kw">def</span> plot_stacked_area(data, exchange_name):</span>
<span id="cb15-54"><a href="#cb15-54"></a>    pivot_df <span class="op">=</span> data.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'tab'</span>, values<span class="op">=</span><span class="st">'num'</span>)</span>
<span id="cb15-55"><a href="#cb15-55"></a>    </span>
<span id="cb15-56"><a href="#cb15-56"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb15-57"><a href="#cb15-57"></a>    pivot_df.plot.area(alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb15-58"><a href="#cb15-58"></a>    plt.title(<span class="ss">f'</span><span class="sc">{</span>exchange_name<span class="sc">}</span><span class="ss">各板块构成变化'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb15-59"><a href="#cb15-59"></a>    plt.xlabel(<span class="st">'年份'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb15-60"><a href="#cb15-60"></a>    plt.ylabel(<span class="st">'上市公司数量'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb15-61"><a href="#cb15-61"></a>    plt.xticks(pivot_df.index.astype(<span class="bu">int</span>),rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb15-62"><a href="#cb15-62"></a>    plt.legend(title<span class="op">=</span><span class="st">'板块分类'</span>)</span>
<span id="cb15-63"><a href="#cb15-63"></a>    plt.tight_layout()</span>
<span id="cb15-64"><a href="#cb15-64"></a>    plt.show()</span>
<span id="cb15-65"><a href="#cb15-65"></a></span>
<span id="cb15-66"><a href="#cb15-66"></a><span class="co"># 深圳堆叠图示例</span></span>
<span id="cb15-67"><a href="#cb15-67"></a>plot_stacked_area(shenzhen, <span class="st">'深圳交易所'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-10-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1000x600 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-10-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="t3-2.2上市公司行业统计和可视化" class="level2" data-number="35.7">
<h2 data-number="35.7" class="anchored" data-anchor-id="t3-2.2上市公司行业统计和可视化"><span class="header-section-number">35.7</span> T3-2.2：上市公司行业统计和可视化</h2>
<div id="8ee30122-920a-499e-9424-9317b322e852" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>industry_sz <span class="op">=</span> pd.read_excel(<span class="st">'./行业统计/深交所.xlsx'</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>industry_sz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">行业名称</th>
<th data-quarto-table-cell-role="th">股票数(只)</th>
<th data-quarto-table-cell-role="th">上市公司家数(家)</th>
<th data-quarto-table-cell-role="th">成交金额(元)</th>
<th data-quarto-table-cell-role="th">成交量</th>
<th data-quarto-table-cell-role="th">总股本</th>
<th data-quarto-table-cell-role="th">总市值</th>
<th data-quarto-table-cell-role="th">流通股本</th>
<th data-quarto-table-cell-role="th">流通市值</th>
<th data-quarto-table-cell-role="th">加权平均市盈率</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>农林牧渔</td>
<td>28</td>
<td>28</td>
<td>4,715,280,155</td>
<td>640,771,376</td>
<td>40,377,151,255</td>
<td>480,608,116,065</td>
<td>33,081,444,905</td>
<td>369,143,762,611</td>
<td>10.71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>采矿业</td>
<td>30</td>
<td>30</td>
<td>7,672,063,953</td>
<td>612,281,828</td>
<td>38,474,148,544</td>
<td>392,151,988,819</td>
<td>34,353,538,996</td>
<td>357,163,745,453</td>
<td>18.20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>制造业</td>
<td>2024</td>
<td>2002</td>
<td>485,567,996,193</td>
<td>36,399,798,171</td>
<td>1,540,637,575,979</td>
<td>23,654,864,805,590</td>
<td>1,369,672,103,971</td>
<td>20,009,323,397,447</td>
<td>25.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>水电煤气</td>
<td>59</td>
<td>57</td>
<td>10,279,143,219</td>
<td>1,632,011,368</td>
<td>132,627,286,520</td>
<td>796,073,997,457</td>
<td>120,381,549,032</td>
<td>713,494,957,000</td>
<td>17.66</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>建筑业</td>
<td>50</td>
<td>50</td>
<td>5,357,910,454</td>
<td>947,148,251</td>
<td>47,368,260,771</td>
<td>255,287,412,558</td>
<td>41,279,688,070</td>
<td>211,442,048,995</td>
<td>18.50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>批发零售</td>
<td>105</td>
<td>101</td>
<td>23,452,636,642</td>
<td>2,322,976,292</td>
<td>96,356,747,614</td>
<td>804,449,557,356</td>
<td>84,504,462,269</td>
<td>685,012,882,272</td>
<td>31.90</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>运输仓储</td>
<td>35</td>
<td>33</td>
<td>6,563,084,824</td>
<td>720,510,915</td>
<td>63,029,454,333</td>
<td>703,312,879,682</td>
<td>47,587,284,276</td>
<td>584,057,077,501</td>
<td>20.19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>住宿餐饮</td>
<td>5</td>
<td>5</td>
<td>432,109,758</td>
<td>88,316,816</td>
<td>2,963,975,442</td>
<td>16,892,145,678</td>
<td>2,829,937,533</td>
<td>15,918,261,694</td>
<td>155.03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>信息技术</td>
<td>259</td>
<td>259</td>
<td>84,163,334,553</td>
<td>5,664,368,326</td>
<td>179,907,540,355</td>
<td>2,537,915,807,464</td>
<td>159,689,970,075</td>
<td>2,106,785,861,257</td>
<td>51.07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>金融业</td>
<td>37</td>
<td>37</td>
<td>16,790,294,056</td>
<td>1,639,146,098</td>
<td>192,151,166,749</td>
<td>1,868,435,610,352</td>
<td>182,883,171,285</td>
<td>1,716,956,544,385</td>
<td>12.45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>房地产</td>
<td>47</td>
<td>45</td>
<td>4,978,396,273</td>
<td>1,332,259,561</td>
<td>95,307,678,793</td>
<td>405,876,221,635</td>
<td>88,036,284,495</td>
<td>383,185,108,658</td>
<td>20.88</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>商务服务</td>
<td>52</td>
<td>50</td>
<td>9,443,781,281</td>
<td>1,504,834,875</td>
<td>80,495,268,291</td>
<td>467,143,265,028</td>
<td>75,685,771,459</td>
<td>433,200,962,908</td>
<td>32.70</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>科研服务</td>
<td>68</td>
<td>68</td>
<td>12,281,498,758</td>
<td>675,889,757</td>
<td>25,275,594,872</td>
<td>400,140,881,158</td>
<td>21,984,191,825</td>
<td>331,002,587,014</td>
<td>39.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>公共环保</td>
<td>56</td>
<td>56</td>
<td>5,544,328,506</td>
<td>774,603,541</td>
<td>49,240,314,140</td>
<td>256,859,215,731</td>
<td>42,291,739,852</td>
<td>206,661,022,065</td>
<td>24.48</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>居民服务</td>
<td>1</td>
<td>1</td>
<td>44,451,767</td>
<td>4,583,393</td>
<td>130,065,904</td>
<td>1,243,430,042</td>
<td>127,217,817</td>
<td>1,216,202,331</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>教育</td>
<td>7</td>
<td>7</td>
<td>1,120,583,218</td>
<td>191,201,455</td>
<td>8,655,089,825</td>
<td>40,473,012,424</td>
<td>7,383,593,487</td>
<td>35,981,461,690</td>
<td>62.12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>卫生</td>
<td>15</td>
<td>15</td>
<td>3,151,683,626</td>
<td>400,520,449</td>
<td>24,945,559,937</td>
<td>221,239,951,310</td>
<td>22,380,150,675</td>
<td>183,701,961,394</td>
<td>37.53</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>文化传播</td>
<td>25</td>
<td>25</td>
<td>5,058,427,010</td>
<td>600,741,009</td>
<td>26,778,957,099</td>
<td>224,272,940,519</td>
<td>23,931,987,141</td>
<td>200,473,750,069</td>
<td>28.65</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>综合</td>
<td>3</td>
<td>3</td>
<td>673,722,096</td>
<td>72,659,617</td>
<td>1,446,056,083</td>
<td>15,262,472,495</td>
<td>1,088,310,773</td>
<td>11,252,737,748</td>
<td>34.41</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>总计</td>
<td>2906</td>
<td>2872</td>
<td>687,290,726,342</td>
<td>56,224,623,098</td>
<td>2,646,167,892,506</td>
<td>33,542,503,711,364</td>
<td>2,359,172,397,936</td>
<td>28,555,974,332,491</td>
<td>-</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="12745452-bd29-48b2-8408-d6e10e2db1cd" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'./行业统计/上交所.json'</span>,<span class="st">'r'</span>,encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb18-2"><a href="#cb18-2"></a>    obj <span class="op">=</span> json.load(f)[<span class="st">"result"</span>]</span>
<span id="cb18-3"><a href="#cb18-3"></a>industry_sh <span class="op">=</span> pd.DataFrame(obj)</span>
<span id="cb18-4"><a href="#cb18-4"></a>industry_sh[<span class="st">'LIST_NUM'</span>] <span class="op">=</span> industry_sh[<span class="st">'LIST_NUM'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>industry_sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CSRC_CODE</th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">CSRC_NAME</th>
<th data-quarto-table-cell-role="th">AVG_PE_RATE</th>
<th data-quarto-table-cell-role="th">AVG_PRICE</th>
<th data-quarto-table-cell-role="th">TRADE_NUM</th>
<th data-quarto-table-cell-role="th">TRADE_DATE</th>
<th data-quarto-table-cell-role="th">LIST_NUM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A01</td>
<td>55820216450</td>
<td>农业</td>
<td>40.29</td>
<td>7.09</td>
<td>5</td>
<td>20250523</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A03</td>
<td>33533941096</td>
<td>畜牧业</td>
<td>25.33</td>
<td>13.01</td>
<td>4</td>
<td>20250523</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A04</td>
<td>7987420101</td>
<td>渔业</td>
<td>54.27</td>
<td>3.59</td>
<td>3</td>
<td>20250523</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A05</td>
<td>5826978123</td>
<td>农、林、牧、渔专业及辅助性活动</td>
<td>56.85</td>
<td>7.26</td>
<td>2</td>
<td>20250523</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>B06</td>
<td>1349106007465</td>
<td>煤炭开采和洗选业</td>
<td>10.89</td>
<td>10.3</td>
<td>21</td>
<td>20250523</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>R86</td>
<td>226465130394</td>
<td>新闻和出版业</td>
<td>18.92</td>
<td>8.86</td>
<td>20</td>
<td>20250523</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>R87</td>
<td>67950094470</td>
<td>广播、电视、电影和录音制作业</td>
<td>142.02</td>
<td>7.45</td>
<td>8</td>
<td>20250523</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>R88</td>
<td>5906223500</td>
<td>文化艺术业</td>
<td>0.0</td>
<td>10.07</td>
<td>1</td>
<td>20250523</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77</td>
<td>R89</td>
<td>7618533752</td>
<td>体育</td>
<td>121.34</td>
<td>7.99</td>
<td>1</td>
<td>20250523</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">78</td>
<td>S91</td>
<td>37457856113</td>
<td>综合</td>
<td>86.25</td>
<td>6.5</td>
<td>3</td>
<td>20250523</td>
<td>3</td>
</tr>
</tbody>
</table>

<p>79 rows × 8 columns</p>
</div>
</div>
</div>
<div id="06816fa5-d88c-4a29-b7c6-61a4323feecb" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>industry_bj <span class="op">=</span> pd.read_csv(<span class="st">'./行业统计/北交所.csv'</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>industry_bj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ts_code</th>
<th data-quarto-table-cell-role="th">symbol</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th">industry</th>
<th data-quarto-table-cell-role="th">list_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>430017.BJ</td>
<td>430017</td>
<td>星昊医药</td>
<td>北京</td>
<td>化学制药</td>
<td>20230531</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>430047.BJ</td>
<td>430047</td>
<td>诺思兰德</td>
<td>北京</td>
<td>生物制药</td>
<td>20201124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>430090.BJ</td>
<td>430090</td>
<td>同辉信息</td>
<td>北京</td>
<td>IT设备</td>
<td>20210809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>430139.BJ</td>
<td>430139</td>
<td>华岭股份</td>
<td>上海</td>
<td>半导体</td>
<td>20221028</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>430198.BJ</td>
<td>430198</td>
<td>微创光电</td>
<td>湖北</td>
<td>IT设备</td>
<td>20200727</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">261</td>
<td>920445.BJ</td>
<td>920445</td>
<td>龙竹科技</td>
<td>福建</td>
<td>家居用品</td>
<td>20200727</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">262</td>
<td>920489.BJ</td>
<td>920489</td>
<td>佳先股份</td>
<td>安徽</td>
<td>化工原料</td>
<td>20200727</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">263</td>
<td>920682.BJ</td>
<td>920682</td>
<td>球冠电缆</td>
<td>浙江</td>
<td>电气设备</td>
<td>20200727</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">264</td>
<td>920799.BJ</td>
<td>920799</td>
<td>艾融软件</td>
<td>上海</td>
<td>软件服务</td>
<td>20200727</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">265</td>
<td>920819.BJ</td>
<td>920819</td>
<td>颖泰生物</td>
<td>北京</td>
<td>农药化肥</td>
<td>20200727</td>
</tr>
</tbody>
</table>

<p>266 rows × 6 columns</p>
</div>
</div>
</div>
<div id="b1f2e5b0-30ab-4935-b478-053cdd644ebf" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a>plt.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> [<span class="st">'SimHei'</span>]  <span class="co"># 设置中文字体</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>plt.rcParams[<span class="st">'axes.unicode_minus'</span>] <span class="op">=</span> <span class="va">False</span>  <span class="co"># 解决负号显示问题</span></span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co"># =====================</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co"># 数据处理部分</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co"># =====================</span></span>
<span id="cb20-12"><a href="#cb20-12"></a></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co"># 深圳交易所处理（已有聚合数据）</span></span>
<span id="cb20-14"><a href="#cb20-14"></a>sz_industry <span class="op">=</span> industry_sz[[<span class="st">'行业名称'</span>, <span class="st">'上市公司家数(家)'</span>]].sort_values(<span class="st">'上市公司家数(家)'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb20-15"><a href="#cb20-15"></a>sz_industry <span class="op">=</span> sz_industry[sz_industry[<span class="st">'行业名称'</span>] <span class="op">!=</span> <span class="st">'总计'</span>] </span>
<span id="cb20-16"><a href="#cb20-16"></a></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co"># 上海交易所处理</span></span>
<span id="cb20-18"><a href="#cb20-18"></a>industry_sh[<span class="st">'trade_year'</span>] <span class="op">=</span> industry_sh[<span class="st">'TRADE_DATE'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>[:<span class="dv">4</span>]</span>
<span id="cb20-19"><a href="#cb20-19"></a>latest_year_sh <span class="op">=</span> industry_sh[<span class="st">'trade_year'</span>].<span class="bu">max</span>()</span>
<span id="cb20-20"><a href="#cb20-20"></a>sh_industry <span class="op">=</span> industry_sh[industry_sh[<span class="st">'trade_year'</span>] <span class="op">==</span> latest_year_sh][[<span class="st">'CSRC_NAME'</span>, <span class="st">'LIST_NUM'</span>]].sort_values(<span class="st">'LIST_NUM'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="co"># 北交所处理</span></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co"># 提取上市年份并筛选最新年度</span></span>
<span id="cb20-23"><a href="#cb20-23"></a>industry_bj[<span class="st">'list_year'</span>] <span class="op">=</span> industry_bj[<span class="st">'list_date'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>[:<span class="dv">4</span>]</span>
<span id="cb20-24"><a href="#cb20-24"></a>latest_year_bj <span class="op">=</span> industry_bj[<span class="st">'list_year'</span>].<span class="bu">max</span>()</span>
<span id="cb20-25"><a href="#cb20-25"></a>bj_industry <span class="op">=</span> pd.DataFrame(industry_bj.groupby([<span class="st">'industry'</span>])[<span class="st">'industry'</span>].count().sort_values(ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb20-26"><a href="#cb20-26"></a>bj_industry.columns <span class="op">=</span> [<span class="st">'count'</span>]</span>
<span id="cb20-27"><a href="#cb20-27"></a>bj_industry <span class="op">=</span> bj_industry.reset_index()</span>
<span id="cb20-28"><a href="#cb20-28"></a><span class="co"># =====================</span></span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="co"># 可视化部分</span></span>
<span id="cb20-30"><a href="#cb20-30"></a><span class="co"># =====================</span></span>
<span id="cb20-31"><a href="#cb20-31"></a></span>
<span id="cb20-32"><a href="#cb20-32"></a><span class="kw">def</span> plot_industry_distribution(data, title, xlabel):</span>
<span id="cb20-33"><a href="#cb20-33"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb20-34"><a href="#cb20-34"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(data, pd.DataFrame):</span>
<span id="cb20-35"><a href="#cb20-35"></a>        <span class="cf">if</span> <span class="st">'count'</span> <span class="kw">in</span> data.columns:</span>
<span id="cb20-36"><a href="#cb20-36"></a>            sns.barplot(y<span class="op">=</span><span class="st">'industry'</span>, x<span class="op">=</span><span class="st">'count'</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb20-37"><a href="#cb20-37"></a>        <span class="cf">else</span>:</span>
<span id="cb20-38"><a href="#cb20-38"></a>            sns.barplot(y<span class="op">=</span>data.columns[<span class="dv">0</span>], x<span class="op">=</span>data.columns[<span class="dv">1</span>], data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb20-39"><a href="#cb20-39"></a>    plt.title(<span class="ss">f'</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">（</span><span class="sc">{</span>latest_year_sh<span class="sc">}</span><span class="ss">年）'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-40"><a href="#cb20-40"></a>    plt.xlabel(xlabel, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-41"><a href="#cb20-41"></a>    plt.ylabel(<span class="st">'行业分类'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-42"><a href="#cb20-42"></a>    plt.tight_layout()</span>
<span id="cb20-43"><a href="#cb20-43"></a>    plt.show()</span>
<span id="cb20-44"><a href="#cb20-44"></a></span>
<span id="cb20-45"><a href="#cb20-45"></a><span class="kw">def</span> process_top10(data, name_col<span class="op">=</span><span class="st">'行业名称'</span>, count_col<span class="op">=</span><span class="st">'上市公司家数(家)'</span>):</span>
<span id="cb20-46"><a href="#cb20-46"></a>    <span class="co"># 确保数据已排序</span></span>
<span id="cb20-47"><a href="#cb20-47"></a>    data_sorted <span class="op">=</span> data.sort_values(count_col, ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-48"><a href="#cb20-48"></a>    </span>
<span id="cb20-49"><a href="#cb20-49"></a>    <span class="co"># 提取前10</span></span>
<span id="cb20-50"><a href="#cb20-50"></a>    top10 <span class="op">=</span> data_sorted.head(<span class="dv">10</span>).copy()</span>
<span id="cb20-51"><a href="#cb20-51"></a>    </span>
<span id="cb20-52"><a href="#cb20-52"></a>    <span class="co"># 计算其他类总和</span></span>
<span id="cb20-53"><a href="#cb20-53"></a>    other_count <span class="op">=</span> data_sorted[count_col][<span class="dv">10</span>:].<span class="bu">sum</span>()</span>
<span id="cb20-54"><a href="#cb20-54"></a>    </span>
<span id="cb20-55"><a href="#cb20-55"></a>    <span class="co"># 创建其他行</span></span>
<span id="cb20-56"><a href="#cb20-56"></a>    other_row <span class="op">=</span> pd.DataFrame({</span>
<span id="cb20-57"><a href="#cb20-57"></a>        name_col: [<span class="st">'其他'</span>],</span>
<span id="cb20-58"><a href="#cb20-58"></a>        count_col: [other_count]</span>
<span id="cb20-59"><a href="#cb20-59"></a>    })</span>
<span id="cb20-60"><a href="#cb20-60"></a>    </span>
<span id="cb20-61"><a href="#cb20-61"></a>    <span class="co"># 合并数据</span></span>
<span id="cb20-62"><a href="#cb20-62"></a>    processed <span class="op">=</span> pd.concat([top10, other_row], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-63"><a href="#cb20-63"></a>    <span class="cf">return</span> processed</span>
<span id="cb20-64"><a href="#cb20-64"></a></span>
<span id="cb20-65"><a href="#cb20-65"></a><span class="co"># 处理各交易所数据</span></span>
<span id="cb20-66"><a href="#cb20-66"></a>sz_top10 <span class="op">=</span> process_top10(sz_industry, <span class="st">'行业名称'</span>, <span class="st">'上市公司家数(家)'</span>)</span>
<span id="cb20-67"><a href="#cb20-67"></a>sh_top10 <span class="op">=</span> process_top10(sh_industry, <span class="st">'CSRC_NAME'</span>, <span class="st">'LIST_NUM'</span>).rename(</span>
<span id="cb20-68"><a href="#cb20-68"></a>    columns<span class="op">=</span>{<span class="st">'CSRC_NAME'</span>:<span class="st">'行业名称'</span>, <span class="st">'LIST_NUM'</span>:<span class="st">'公司数量'</span>})</span>
<span id="cb20-69"><a href="#cb20-69"></a>bj_top10 <span class="op">=</span> process_top10(bj_industry, <span class="st">'industry'</span>, <span class="st">'count'</span>).rename(</span>
<span id="cb20-70"><a href="#cb20-70"></a>    columns<span class="op">=</span>{<span class="st">'industry'</span>:<span class="st">'行业名称'</span>, <span class="st">'count'</span>:<span class="st">'公司数量'</span>})</span>
<span id="cb20-71"><a href="#cb20-71"></a></span>
<span id="cb20-72"><a href="#cb20-72"></a><span class="co"># =====================</span></span>
<span id="cb20-73"><a href="#cb20-73"></a><span class="co"># 饼图可视化函数</span></span>
<span id="cb20-74"><a href="#cb20-74"></a><span class="co"># =====================</span></span>
<span id="cb20-75"><a href="#cb20-75"></a><span class="kw">def</span> plot_pie(data, title, year):</span>
<span id="cb20-76"><a href="#cb20-76"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb20-77"><a href="#cb20-77"></a>    </span>
<span id="cb20-78"><a href="#cb20-78"></a>    <span class="co"># 准备数据</span></span>
<span id="cb20-79"><a href="#cb20-79"></a>    labels <span class="op">=</span> data.iloc[:, <span class="dv">0</span>]</span>
<span id="cb20-80"><a href="#cb20-80"></a>    sizes <span class="op">=</span> data.iloc[:, <span class="dv">1</span>]</span>
<span id="cb20-81"><a href="#cb20-81"></a>    </span>
<span id="cb20-82"><a href="#cb20-82"></a>    <span class="co"># 绘制饼图</span></span>
<span id="cb20-83"><a href="#cb20-83"></a>    wedges, texts, autotexts <span class="op">=</span> plt.pie(</span>
<span id="cb20-84"><a href="#cb20-84"></a>        sizes, </span>
<span id="cb20-85"><a href="#cb20-85"></a>        labels<span class="op">=</span>labels,</span>
<span id="cb20-86"><a href="#cb20-86"></a>        autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>,</span>
<span id="cb20-87"><a href="#cb20-87"></a>        startangle<span class="op">=</span><span class="dv">140</span>,</span>
<span id="cb20-88"><a href="#cb20-88"></a>        pctdistance<span class="op">=</span><span class="fl">0.85</span>,</span>
<span id="cb20-89"><a href="#cb20-89"></a>        textprops<span class="op">=</span>{<span class="st">'fontsize'</span>:<span class="dv">10</span>}</span>
<span id="cb20-90"><a href="#cb20-90"></a>    )</span>
<span id="cb20-91"><a href="#cb20-91"></a>    </span>
<span id="cb20-92"><a href="#cb20-92"></a>    <span class="co"># 美化标签</span></span>
<span id="cb20-93"><a href="#cb20-93"></a>    plt.setp(autotexts, size<span class="op">=</span><span class="dv">10</span>, weight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb20-94"><a href="#cb20-94"></a>    plt.title(<span class="ss">f'</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">（</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">年）'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-95"><a href="#cb20-95"></a>    </span>
<span id="cb20-96"><a href="#cb20-96"></a>    <span class="co"># 添加中心空白</span></span>
<span id="cb20-97"><a href="#cb20-97"></a>    centre_circle <span class="op">=</span> plt.Circle((<span class="dv">0</span>,<span class="dv">0</span>),<span class="fl">0.70</span>,fc<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb20-98"><a href="#cb20-98"></a>    plt.gcf().gca().add_artist(centre_circle)</span>
<span id="cb20-99"><a href="#cb20-99"></a>    </span>
<span id="cb20-100"><a href="#cb20-100"></a>    plt.axis(<span class="st">'equal'</span>)</span>
<span id="cb20-101"><a href="#cb20-101"></a>    plt.tight_layout()</span>
<span id="cb20-102"><a href="#cb20-102"></a>    plt.show()</span>
<span id="cb20-103"><a href="#cb20-103"></a></span>
<span id="cb20-104"><a href="#cb20-104"></a><span class="co"># 绘制深圳饼图</span></span>
<span id="cb20-105"><a href="#cb20-105"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">深圳交易所行业分布（前10+其他）:"</span>)</span>
<span id="cb20-106"><a href="#cb20-106"></a>plot_pie(sz_top10, <span class="st">'深圳交易所上市公司行业分布'</span>, latest_year_sh)</span>
<span id="cb20-107"><a href="#cb20-107"></a></span>
<span id="cb20-108"><a href="#cb20-108"></a><span class="co"># 绘制上海饼图</span></span>
<span id="cb20-109"><a href="#cb20-109"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">上海交易所行业分布（前10+其他）:"</span>)</span>
<span id="cb20-110"><a href="#cb20-110"></a>plot_pie(sh_top10, <span class="st">'上海交易所上市公司行业分布'</span>, latest_year_sh)</span>
<span id="cb20-111"><a href="#cb20-111"></a></span>
<span id="cb20-112"><a href="#cb20-112"></a><span class="co"># 绘制北交所饼图</span></span>
<span id="cb20-113"><a href="#cb20-113"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">北交所行业分布（前10+其他）:"</span>)</span>
<span id="cb20-114"><a href="#cb20-114"></a>plot_pie(bj_top10, <span class="st">'北交所上市公司行业分布'</span>, latest_year_bj)</span>
<span id="cb20-115"><a href="#cb20-115"></a></span>
<span id="cb20-116"><a href="#cb20-116"></a><span class="co"># 输出处理后的数据</span></span>
<span id="cb20-117"><a href="#cb20-117"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">深圳前10+其他数据："</span>)</span>
<span id="cb20-118"><a href="#cb20-118"></a><span class="bu">print</span>(sz_top10)</span>
<span id="cb20-119"><a href="#cb20-119"></a></span>
<span id="cb20-120"><a href="#cb20-120"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">上海前10+其他数据："</span>)</span>
<span id="cb20-121"><a href="#cb20-121"></a><span class="bu">print</span>(sh_top10)</span>
<span id="cb20-122"><a href="#cb20-122"></a></span>
<span id="cb20-123"><a href="#cb20-123"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">北交所前10+其他数据："</span>)</span>
<span id="cb20-124"><a href="#cb20-124"></a><span class="bu">print</span>(bj_top10)</span>
<span id="cb20-125"><a href="#cb20-125"></a></span>
<span id="cb20-126"><a href="#cb20-126"></a>    </span>
<span id="cb20-127"><a href="#cb20-127"></a>    </span>
<span id="cb20-128"><a href="#cb20-128"></a><span class="co"># 绘制深圳交易所行业分布</span></span>
<span id="cb20-129"><a href="#cb20-129"></a><span class="bu">print</span>(<span class="st">"深圳交易所行业分布："</span>)</span>
<span id="cb20-130"><a href="#cb20-130"></a>plot_industry_distribution(sz_industry, <span class="st">'深圳交易所上市公司行业分布'</span>, <span class="st">'上市公司数量（家）'</span>)</span>
<span id="cb20-131"><a href="#cb20-131"></a></span>
<span id="cb20-132"><a href="#cb20-132"></a><span class="co"># 绘制上海交易所行业分布</span></span>
<span id="cb20-133"><a href="#cb20-133"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">上海交易所行业分布："</span>)</span>
<span id="cb20-134"><a href="#cb20-134"></a>plot_industry_distribution(sh_industry, <span class="st">'上海交易所上市公司行业分布'</span>, <span class="st">'上市公司数量（家）'</span>)</span>
<span id="cb20-135"><a href="#cb20-135"></a></span>
<span id="cb20-136"><a href="#cb20-136"></a><span class="co"># 绘制北交所行业分布</span></span>
<span id="cb20-137"><a href="#cb20-137"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">北交所行业分布："</span>)</span>
<span id="cb20-138"><a href="#cb20-138"></a>plot_industry_distribution(bj_industry, <span class="st">'北交所上市公司行业分布'</span>, <span class="st">'上市公司数量（家）'</span>)</span>
<span id="cb20-139"><a href="#cb20-139"></a></span>
<span id="cb20-140"><a href="#cb20-140"></a><span class="co"># =====================</span></span>
<span id="cb20-141"><a href="#cb20-141"></a><span class="co"># 数据表格输出</span></span>
<span id="cb20-142"><a href="#cb20-142"></a><span class="co"># =====================</span></span>
<span id="cb20-143"><a href="#cb20-143"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">深圳交易所行业分布数据："</span>)</span>
<span id="cb20-144"><a href="#cb20-144"></a><span class="bu">print</span>(sz_industry.head(<span class="dv">10</span>))</span>
<span id="cb20-145"><a href="#cb20-145"></a></span>
<span id="cb20-146"><a href="#cb20-146"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">上海交易所行业分布数据："</span>)</span>
<span id="cb20-147"><a href="#cb20-147"></a><span class="bu">print</span>(sh_industry.head(<span class="dv">10</span>))</span>
<span id="cb20-148"><a href="#cb20-148"></a></span>
<span id="cb20-149"><a href="#cb20-149"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">北交所行业分布数据："</span>)</span>
<span id="cb20-150"><a href="#cb20-150"></a><span class="bu">print</span>(bj_industry.head(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
深圳交易所行业分布（前10+其他）:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-14-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
上海交易所行业分布（前10+其他）:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-14-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
北交所行业分布（前10+其他）:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-14-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
深圳前10+其他数据：
    行业名称  上市公司家数(家)
0    制造业       2002
1   信息技术        259
2   批发零售        101
3   科研服务         68
4   水电煤气         57
5   公共环保         56
6   商务服务         50
7    建筑业         50
8    房地产         45
9    金融业         37
10    其他        147

上海前10+其他数据：
                行业名称  公司数量
0   计算机、通信和其他电子设备制造业   248
1            专用设备制造业   167
2       化学原料和化学制品制造业   147
3              医药制造业   146
4         软件和信息技术服务业   133
5         电气机械和器材制造业   130
6            通用设备制造业    90
7              汽车制造业    84
8               房地产业    55
9        电力、热力生产和供应业    54
10                其他  1071

北交所前10+其他数据：
    行业名称  公司数量
0   汽车配件    20
1   软件服务    20
2   电气设备    18
3   机械基件    18
4   专用机械    17
5   化工原料    16
6    元器件    16
7   电器仪表    15
8     塑料     9
9   化学制药     9
10    其他   108
深圳交易所行业分布：</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\xiaor\AppData\Local\Temp\ipykernel_4016\1933422641.py:38: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(y=data.columns[0], x=data.columns[1], data=data, palette='viridis')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-14-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
上海交易所行业分布：</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\xiaor\AppData\Local\Temp\ipykernel_4016\1933422641.py:38: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(y=data.columns[0], x=data.columns[1], data=data, palette='viridis')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-14-output-12.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
北交所行业分布：</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\xiaor\AppData\Local\Temp\ipykernel_4016\1933422641.py:36: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(y='industry', x='count', data=data, palette='viridis')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="G8_China_stock_analysis_files/figure-html/cell-14-output-15.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
深圳交易所行业分布数据：
    行业名称  上市公司家数(家)
2    制造业       2002
8   信息技术        259
5   批发零售        101
12  科研服务         68
3   水电煤气         57
13  公共环保         56
11  商务服务         50
4    建筑业         50
10   房地产         45
9    金融业         37

上海交易所行业分布数据：
           CSRC_NAME  LIST_NUM
35  计算机、通信和其他电子设备制造业       248
31           专用设备制造业       167
22      化学原料和化学制品制造业       147
23             医药制造业       146
60        软件和信息技术服务业       133
34        电气机械和器材制造业       130
30           通用设备制造业        90
32             汽车制造业        84
65              房地产业        55
39       电力、热力生产和供应业        54

北交所行业分布数据：
  industry  count
0     汽车配件     20
1     软件服务     20
2     电气设备     18
3     机械基件     18
4     专用机械     17
5     化工原料     16
6      元器件     16
7     电器仪表     15
8       塑料      9
9     化学制药      9</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/book\.lianxh\.cn\/ds\/index\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../homework/pre/Dangdang_G7_02_data_analysis.html" class="pagination-link" aria-label="当当网-G7-02">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">当当网-G7-02</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../homework/pre/Stock_G4_01_data_crawler.html" class="pagination-link" aria-label="G4-01">
        <span class="nav-page-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">G4-01</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><a href="https://www.lianxh.cn">www.lianxh.cn</a></p>
</div>
    <div class="nav-footer-right">
<p>Support: <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>